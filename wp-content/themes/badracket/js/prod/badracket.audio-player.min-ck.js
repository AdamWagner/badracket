function updateView(){return function(e,t){br_state.viewSet(t)}}function doMoreStuff(){var e,t;console.log("do more stuff ran");e=br_player.history.album.random();t=br_player.albumData.sampleSong(e);br_player.history.update(e,t);br_player.ui.render.init(e,t);br_player.ui.bindui.album();br_player.ui.bindui.song();br_player.ui.bindui.slider();br_player.ui.bindui.play();br_player.ui.bindui.next();br_player.ui.bindui.buyAlbum();br_player.ui.bindui.buyAlbumHover();br_player.ui.bindui.previous()}var br_sm2,br_inline_player,br_player,init;(function(e,t){function n(t,n){var i,s,o,u=t.nodeName.toLowerCase();if("area"===u){i=t.parentNode;s=i.name;if(!t.href||!s||i.nodeName.toLowerCase()!=="map")return!1;o=e("img[usemap=#"+s+"]")[0];return!!o&&r(o)}return(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&r(t)}function r(t){return e.expr.filters.visible(t)&&!e(t).parents().andSelf().filter(function(){return e.css(this,"visibility")==="hidden"}).length}var i=0,s=/^ui-id-\d+$/;e.ui=e.ui||{};if(e.ui.version)return;e.extend(e.ui,{version:"1.9.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return typeof t=="number"?this.each(function(){var r=this;setTimeout(function(){e(r).focus();n&&n.call(r)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):t=this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0);return/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){var r,i,s;if(n!==t)return this.css("zIndex",n);if(this.length){r=e(this[0]);while(r.length&&r[0]!==document){i=r.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){s=parseInt(r.css("zIndex"),10);if(!isNaN(s)&&s!==0)return s}r=r.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++i)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&e(this).removeAttr("id")})}});e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var r=e.attr(t,"tabindex"),i=isNaN(r);return(i||r>=0)&&n(t,!i)}});e(function(){var t=document.body,n=t.appendChild(n=document.createElement("div"));n.offsetHeight;e.extend(n.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});e.support.minHeight=n.offsetHeight===100;e.support.selectstart="onselectstart"in n;t.removeChild(n).style.display="none"});e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function i(t,n,r,i){e.each(s,function(){n-=parseFloat(e.css(t,"padding"+this))||0;r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0);i&&(n-=parseFloat(e.css(t,"margin"+this))||0)});return n}var s=r==="Width"?["Left","Right"]:["Top","Bottom"],o=r.toLowerCase(),u={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?u["inner"+r].call(this):this.each(function(){e(this).css(o,i(this,n)+"px")})};e.fn["outer"+r]=function(t,n){return typeof t!="number"?u["outer"+r].call(this,t):this.each(function(){e(this).css(o,i(this,t,!0,n)+"px")})}});e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData));(function(){var t=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];e.ui.ie=t.length?!0:!1;e.ui.ie6=parseFloat(t[1],10)===6})();e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r){s.plugins[i]=s.plugins[i]||[];s.plugins[i].push([n,r[i]])}},call:function(e,t,n){var r,i=e.plugins[t];if(!i||!e.element[0].parentNode||e.element[0].parentNode.nodeType===11)return;for(r=0;r<i.length;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},contains:e.contains,hasScroll:function(t,n){var r,i;if(e(t).css("overflow")==="hidden")return!1;r=n&&n==="left"?"scrollLeft":"scrollTop",i=!1;if(t[r]>0)return!0;t[r]=1;i=t[r]>0;t[r]=0;return i},isOverAxis:function(e,t,n){return e>t&&e<t+n},isOver:function(t,n,r,i,s,o){return e.ui.isOverAxis(t,r,s)&&e.ui.isOverAxis(n,i,o)}})})(jQuery);(function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){var n,r;for(n=0;(r=t[n])!=null;n++)try{e(r).triggerHandler("remove")}catch(s){}i(t)};e.widget=function(t,n,r){var i,s,o,u,a=t.split(".")[0];t=t.split(".")[1];i=a+"-"+t;if(!r){r=n;n=e.Widget}e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)};e[a]=e[a]||{};s=e[a][t];o=e[a][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)};e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]});u=new n;u.options=e.widget.extend({},u.options);e.each(r,function(t,i){e.isFunction(i)&&(r[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,s=this._superApply;this._super=e;this._superApply=r;t=i.apply(this,arguments);this._super=n;this._superApply=s;return t}}())});o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix:t},r,{constructor:o,namespace:a,widgetName:t,widgetBaseClass:i,widgetFullName:i});if(s){e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)});delete s._childConstructors}else n._childConstructors.push(o);e.widget.bridge(t,o)};e.widget.extend=function(n){var i,s,o=r.call(arguments,1),u=0,a=o.length;for(;u<a;u++)for(i in o[u]){s=o[u][i];o[u].hasOwnProperty(i)&&s!==t&&(e.isPlainObject(s)?n[i]=e.isPlainObject(n[i])?e.widget.extend({},n[i],s):e.widget.extend({},s):n[i]=s)}return n};e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName||n;e.fn[n]=function(o){var u=typeof o=="string",a=r.call(arguments,1),f=this;o=!u&&a.length?e.widget.extend.apply(null,[o].concat(a)):o;u?this.each(function(){var r,i=e.data(this,s);if(!i)return e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'");if(!e.isFunction(i[o])||o.charAt(0)==="_")return e.error("no such method '"+o+"' for "+n+" widget instance");r=i[o].apply(i,a);if(r!==i&&r!==t){f=r&&r.jquery?f.pushStack(r.get()):r;return!1}}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():e.data(this,s,new i(o,this))});return f}};e.Widget=function(){};e.Widget._childConstructors=[];e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0];this.element=e(r);this.uuid=n++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=e.widget.extend({},this.options,this._getCreateOptions(),t);this.bindings=e();this.hoverable=e();this.focusable=e();if(r!==this){e.data(r,this.widgetName,this);e.data(r,this.widgetFullName,this);this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}});this.document=e(r.style?r.ownerDocument:r.document||r);this.window=e(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i,s,o,u=n;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof n=="string"){u={};i=n.split(".");n=i.shift();if(i.length){s=u[n]=e.widget.extend({},this.options[n]);for(o=0;o<i.length-1;o++){s[i[o]]=s[i[o]]||{};s=s[i[o]]}n=i.pop();if(r===t)return s[n]===t?null:s[n];s[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];u[n]=r}}this._setOptions(u);return this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){this.options[e]=t;if(e==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,r){var i,s=this;if(typeof t!="boolean"){r=n;n=t;t=!1}if(!r){r=n;n=this.element;i=this.widget()}else{n=i=e(n);this.bindings=this.bindings.add(n)}e.each(r,function(r,o){function u(){if(!t&&(s.options.disabled===!0||e(this).hasClass("ui-state-disabled")))return;return(typeof o=="string"?s[o]:o).apply(s,arguments)}var a,f,l;typeof o!="string"&&(u.guid=o.guid=o.guid||u.guid||e.guid++);a=r.match(/^(\w+)\s*(.*)$/),f=a[1]+s.eventNamespace,l=a[2];l?i.delegate(l,f,u):n.bind(f,u)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return(typeof e=="string"?r[e]:e).apply(r,arguments)}var r;r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t);this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t);this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{};n=e.Event(n);n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase();n.target=this.element[0];s=n.originalEvent;if(s)for(i in s)i in n||(n[i]=s[i]);this.element.trigger(n,r);return!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}};e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){var o,u;typeof i=="string"&&(i={effect:i});u=i?i===!0||typeof i=="number"?n:i.effect||n:t;i=i||{};typeof i=="number"&&(i={duration:i});o=!e.isEmptyObject(i);i.complete=s;i.delay&&r.delay(i.delay);o&&e.effects&&(e.effects.effect[u]||e.uiBackCompat!==!1&&e.effects[u])?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t]();s&&s.call(r[0]);n()})}});e.uiBackCompat!==!1&&(e.Widget.prototype._getCreateOptions=function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]})})(jQuery);(function(e){var t=!1;e(document).mouseup(function(){t=!1});e.widget("ui.mouse",{version:"1.9.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent")){e.removeData(n.target,t.widgetName+".preventClickEvent");n.stopImmediatePropagation();return!1}});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){var r,i,s;if(t)return;this._mouseStarted&&this._mouseUp(n);this._mouseDownEvent=n;r=this,i=n.which===1,s=typeof this.options.cancel=="string"&&n.target.nodeName?e(n.target).closest(this.options.cancel).length:!1;if(!i||s||!this._mouseCapture(n))return!0;this.mouseDelayMet=!this.options.delay;this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(n)&&this._mouseDelayMet(n)){this._mouseStarted=this._mouseStart(n)!==!1;if(!this._mouseStarted){n.preventDefault();return!0}}!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(e){return r._mouseMove(e)};this._mouseUpDelegate=function(e){return r._mouseUp(e)};e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);n.preventDefault();t=!0;return!0},_mouseMove:function(t){if(!e.ui.ie||document.documentMode>=9||!!t.button){if(this._mouseStarted){this._mouseDrag(t);return t.preventDefault()}if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1;this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)}return!this._mouseStarted}return this._mouseUp(t)},_mouseUp:function(t){e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=!1;t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0);this._mouseStop(t)}return!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery);(function(e){var t=5;e.widget("ui.slider",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var n,r,i=this.options,s=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",u=[];this._keySliding=!1;this._mouseSliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"+(i.disabled?" ui-slider-disabled ui-disabled":""));this.range=e([]);if(i.range){if(i.range===!0){i.values||(i.values=[this._valueMin(),this._valueMin()]);i.values.length&&i.values.length!==2&&(i.values=[i.values[0],i.values[0]])}this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(i.range==="min"||i.range==="max"?" ui-slider-range-"+i.range:""))}r=i.values&&i.values.length||1;for(n=s.length;n<r;n++)u.push(o);this.handles=s.add(e(u.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(e){e.preventDefault()}).mouseenter(function(){i.disabled||e(this).addClass("ui-state-hover")}).mouseleave(function(){e(this).removeClass("ui-state-hover")}).focus(function(){if(!i.disabled){e(".ui-slider .ui-state-focus").removeClass("ui-state-focus");e(this).addClass("ui-state-focus")}else e(this).blur()}).blur(function(){e(this).removeClass("ui-state-focus")});this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)});this._on(this.handles,{keydown:function(n){var r,i,s,o,u=e(n.target).data("ui-slider-handle-index");switch(n.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:n.preventDefault();if(!this._keySliding){this._keySliding=!0;e(n.target).addClass("ui-state-active");r=this._start(n,u);if(r===!1)return}}o=this.options.step;this.options.values&&this.options.values.length?i=s=this.values(u):i=s=this.value();switch(n.keyCode){case e.ui.keyCode.HOME:s=this._valueMin();break;case e.ui.keyCode.END:s=this._valueMax();break;case e.ui.keyCode.PAGE_UP:s=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.PAGE_DOWN:s=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(i===this._valueMax())return;s=this._trimAlignValue(i+o);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i===this._valueMin())return;s=this._trimAlignValue(i-o)}this._slide(n,u,s)},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");if(this._keySliding){this._keySliding=!1;this._stop(t,n);this._change(t,n);e(t.target).removeClass("ui-state-active")}}});this._refreshValue();this._animateOff=!1},_destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all");this._mouseDestroy()},_mouseCapture:function(t){var n,r,i,s,o,u,a,f,l=this,c=this.options;if(c.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();n={x:t.pageX,y:t.pageY};r=this._normValueFromMouse(n);i=this._valueMax()-this._valueMin()+1;this.handles.each(function(t){var n=Math.abs(r-l.values(t));if(i>n){i=n;s=e(this);o=t}});if(c.range===!0&&this.values(1)===c.min){o+=1;s=e(this.handles[o])}u=this._start(t,o);if(u===!1)return!1;this._mouseSliding=!0;this._handleIndex=o;s.addClass("ui-state-active").focus();a=s.offset();f=!e(t.target).parents().andSelf().is(".ui-slider-handle");this._clickOffset=f?{left:0,top:0}:{left:t.pageX-a.left-s.width()/2,top:t.pageY-a.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(t,o,r);this._animateOff=!0;return!0},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);this._slide(e,this._handleIndex,n);return!1},_mouseStop:function(e){this.handles.removeClass("ui-state-active");this._mouseSliding=!1;this._stop(e,this._handleIndex);this._change(e,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=!1;return!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,r,i,s;if(this.orientation==="horizontal"){t=this.elementSize.width;n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{t=this.elementSize.height;n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}r=n/t;r>1&&(r=1);r<0&&(r=0);this.orientation==="vertical"&&(r=1-r);i=this._valueMax()-this._valueMin();s=this._valueMin()+r*i;return this._trimAlignValue(s)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};if(this.options.values&&this.options.values.length){n.value=this.values(t);n.values=this.values()}return this._trigger("start",e,n)},_slide:function(e,t,n){var r,i,s;if(this.options.values&&this.options.values.length){r=this.values(t?0:1);this.options.values.length===2&&this.options.range===!0&&(t===0&&n>r||t===1&&n<r)&&(n=r);if(n!==this.values(t)){i=this.values();i[t]=n;s=this._trigger("slide",e,{handle:this.handles[t],value:n,values:i});r=this.values(t?0:1);s!==!1&&this.values(t,n,!0)}}else if(n!==this.value()){s=this._trigger("slide",e,{handle:this.handles[t],value:n});s!==!1&&this.value(n)}},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};if(this.options.values&&this.options.values.length){n.value=this.values(t);n.values=this.values()}this._trigger("stop",e,n)},_change:function(e,t){var n;if(!this._keySliding&&!this._mouseSliding){n={handle:this.handles[t],value:this.value()};if(this.options.values&&this.options.values.length){n.value=this.values(t);n.values=this.values()}this._trigger("change",e,n)}},value:function(e){if(arguments.length){this.options.value=this._trimAlignValue(e);this._refreshValue();this._change(null,0);return}return this._value()},values:function(t,n){var r,i,s;if(arguments.length>1){this.options.values[t]=this._trimAlignValue(n);this._refreshValue();this._change(null,t);return}if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();r=this.options.values;i=arguments[0];for(s=0;s<r.length;s+=1){r[s]=this._trimAlignValue(i[s]);this._change(null,s)}this._refreshValue()},_setOption:function(t,n){var r,i=0;e.isArray(this.options.values)&&(i=this.options.values.length);e.Widget.prototype._setOption.apply(this,arguments);switch(t){case"disabled":if(n){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.prop("disabled",!0);this.element.addClass("ui-disabled")}else{this.handles.prop("disabled",!1);this.element.removeClass("ui-disabled")}break;case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case"values":this._animateOff=!0;this._refreshValue();for(r=0;r<i;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0;this._refreshValue();this._animateOff=!1}},_value:function(){var e=this.options.value;e=this._trimAlignValue(e);return e},_values:function(e){var t,n,r;if(arguments.length){t=this.options.values[e];t=this._trimAlignValue(t);return t}n=this.options.values.slice();for(r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(n[r]);return n},_trimAlignValue:function(e){var t,n,r;if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,r=e-n;Math.abs(n)*2>=t&&(r+=n>0?t:-t);return parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,r,i,s,o=this.options.range,u=this.options,a=this,f=this._animateOff?!1:u.animate,l={};if(this.options.values&&this.options.values.length)this.handles.each(function(r){n=(a.values(r)-a._valueMin())/(a._valueMax()-a._valueMin())*100;l[a.orientation==="horizontal"?"left":"bottom"]=n+"%";e(this).stop(1,1)[f?"animate":"css"](l,u.animate);if(a.options.range===!0)if(a.orientation==="horizontal"){r===0&&a.range.stop(1,1)[f?"animate":"css"]({left:n+"%"},u.animate);r===1&&a.range[f?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:u.animate})}else{r===0&&a.range.stop(1,1)[f?"animate":"css"]({bottom:n+"%"},u.animate);r===1&&a.range[f?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:u.animate})}t=n});else{r=this.value();i=this._valueMin();s=this._valueMax();n=s!==i?(r-i)/(s-i)*100:0;l[this.orientation==="horizontal"?"left":"bottom"]=n+"%";this.handle.stop(1,1)[f?"animate":"css"](l,u.animate);o==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[f?"animate":"css"]({width:n+"%"},u.animate);o==="max"&&this.orientation==="horizontal"&&this.range[f?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:u.animate});o==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[f?"animate":"css"]({height:n+"%"},u.animate);o==="max"&&this.orientation==="vertical"&&this.range[f?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:u.animate})}}})})(jQuery);(function(e,t){"use strict";function n(n,r){function i(e){return u.preferFlash&&Bt&&!u.ignoreFlash&&u.flash[e]!==t&&u.flash[e]}function s(e){return function(t){var n,r=this._s;if(!r||!r._a){r&&r.id?u._wD(r.id+": Ignoring "+t.type):u._wD(h+"Ignoring "+t.type);n=null}else n=e.call(this,t);return n}}var o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St,xt,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt,Pt,Ht,Bt,jt,Ft,It,qt,Rt,Ut,zt,Wt,Xt,Vt,$t,Jt,Kt,Qt,Gt,Yt,Zt,en,tn,nn,rn,sn,on,un;this.setupOptions={url:n||null,flashVersion:8,debugMode:!0,debugFlash:!1,useConsole:!0,consoleOnly:!0,waitForWindowLoad:!1,bgColor:"#ffffff",useHighPerformance:!1,flashPollingInterval:null,html5PollingInterval:null,flashLoadTimeout:1e3,wmode:null,allowScriptAccess:"always",useFlashBlock:!1,useHTML5Audio:!0,html5Test:/^(probably|maybe)$/i,preferFlash:!0,noSWFCache:!1};this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100};this.flash9Options={isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null};this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null};this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a","m4b"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}};this.movieID="sm2-container";this.id=r||"sm2movie";this.debugID="soundmanager-debug";this.debugURLParam=/([#?&])debug=1/i;this.versionNumber="V2.97a.20130101";this.version=null;this.movieURL=null;this.altURL=null;this.swfLoaded=!1;this.enabled=!1;this.oMC=null;this.sounds={};this.soundIDs=[];this.muted=!1;this.didFlashBlock=!1;this.filePattern=null;this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i};this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1};this.sandbox={type:null,types:{remote:"remote (domain-based) rules",localWithFile:"local with file access (no internet access)",localWithNetwork:"local with network (internet access only, no local access)",localTrusted:"local, trusted (local+internet access)"},description:null,noRemote:null,noLocal:null};this.html5={usingFlash:null};this.flash={};this.html5Only=!1;this.ignoreFlash=!1;u=this,a=null,f=null,l="soundManager",c=l+": ",h="HTML5::",d=navigator.userAgent,v=e.location.href.toString(),m=document,E=[],S=!0,T=!1,N=!1,C=!1,k=!1,L=!1,O=0,Z=["log","info","warn","error"],et=8,it=null,st=null,vt=!1,mt=!1,wt=0,Et=null,xt=[],Tt=null,Dt=Array.prototype.slice,Pt=!1,Ut=d.match(/(ipad|iphone|ipod)/i),zt=d.match(/android/i),Wt=d.match(/msie/i),Xt=d.match(/webkit/i),Vt=d.match(/safari/i)&&!d.match(/chrome/i),$t=d.match(/opera/i),Jt=d.match(/(mobile|pre\/|xoom)/i)||Ut||zt,Kt=!v.match(/usehtml5audio/i)&&!v.match(/sm2\-ignorebadua/i)&&Vt&&!d.match(/silk/i)&&d.match(/OS X 10_6_([3-7])/i),Qt=e.console!==t&&console.log!==t,Gt=m.hasFocus!==t?m.hasFocus():null,Yt=Vt&&(m.hasFocus===t||!m.hasFocus()),Zt=!Yt,en=/(mp3|mp4|mpa|m4a|m4b)/i,tn="about:blank",nn=m.location?m.location.protocol.match(/http/i):null,rn=nn?"":"http://",sn=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|m4b|mp4v|3gp|3g2)\s*(?:$|;)/i,on=["mpeg4","aac","flv","mov","mp4","m4v","f4v","m4a","m4b","mp4v","3gp","3g2"],un=new RegExp("\\.("+on.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i;this.useAltURL=!nn;ft={swfBox:"sm2-object-box",swfDefault:"movieContainer",swfError:"swf_error",swfTimedout:"swf_timedout",swfLoaded:"swf_loaded",swfUnblocked:"swf_unblocked",sm2Debug:"sm2_debug",highPerf:"high_performance",flashDebug:"flash_debug"};this.hasHTML5=function(){try{return Audio!==t&&($t&&opera!==t&&opera.version()<10?new Audio(null):new Audio).canPlayType!==t}catch(e){return!1}}();this.setup=function(e){var n=!u.url;e!==t&&C&&Tt&&u.ok()&&(e.flashVersion!==t||e.url!==t||e.html5Test!==t)&&pt(ot("setupLate"));D(e);n&&$&&e.url!==t&&u.beginDelayedInit();!$&&e.url!==t&&m.readyState==="complete"&&setTimeout(X,1);return u};this.ok=function(){return Tt?C&&!k:u.useHTML5Audio&&u.hasHTML5};this.supported=this.ok;this.getMovie=function(t){return p(t)||m[t]||e[t]};this.createSound=function(e,n){function r(){i=ct(i);u.sounds[i.id]=new o(i);u.soundIDs.push(i.id);return u.sounds[i.id]}var i,s=null,a=l+".createSound(): ",c=a+ot(C?"notOK":"notReady");if(!C||!u.ok()){pt(c);return!1}n!==t&&(e={id:e,url:n});i=_(e);i.url=St(i.url);i.id.toString().charAt(0).match(/^[0-9]$/)&&u._wD(a+ot("badID",i.id),2);u._wD(a+i.id+" ("+i.url+")",1);if(dt(i.id,!0)){u._wD(a+i.id+" exists",1);return u.sounds[i.id]}if(Ct(i)){s=r();u._wD(i.id+": Using HTML5");s._setup_html5(i)}else{if(w>8){i.isMovieStar===null&&(i.isMovieStar=!!(i.serverURL||(i.type?i.type.match(sn):!1)||i.url.match(un)));if(i.isMovieStar){u._wD(a+"using MovieStar handling");i.loops>1&&A("noNSLoop")}}i=ht(i,a);s=r();if(w===8)f._createSound(i.id,i.loops||1,i.usePolicyFile);else{f._createSound(i.id,i.url,i.usePeakData,i.useWaveformData,i.useEQData,i.isMovieStar,i.isMovieStar?i.bufferTime:!1,i.loops||1,i.serverURL,i.duration||null,i.autoPlay,!0,i.autoLoad,i.usePolicyFile);if(!i.serverURL){s.connected=!0;i.onconnect&&i.onconnect.apply(s)}}!i.serverURL&&(i.autoLoad||i.autoPlay)&&s.load(i)}!i.serverURL&&i.autoPlay&&s.play();return s};this.destroySound=function(e,t){var n,r;if(!dt(e))return!1;n=u.sounds[e];n._iO={};n.stop();n.unload();for(r=0;r<u.soundIDs.length;r++)if(u.soundIDs[r]===e){u.soundIDs.splice(r,1);break}t||n.destruct(!0);n=null;delete u.sounds[e];return!0};this.load=function(e,t){return dt(e)?u.sounds[e].load(t):!1};this.unload=function(e){return dt(e)?u.sounds[e].unload():!1};this.onPosition=function(e,t,n,r){return dt(e)?u.sounds[e].onposition(t,n,r):!1};this.onposition=this.onPosition;this.clearOnPosition=function(e,t,n){return dt(e)?u.sounds[e].clearOnPosition(t,n):!1};this.play=function(e,t){var n=!1;if(!C||!u.ok()){pt(l+".play(): "+ot(C?"notOK":"notReady"));return n}if(!dt(e)){t instanceof Object||(t={url:t});if(t&&t.url){u._wD(l+'.play(): attempting to create "'+e+'"',1);t.id=e;n=u.createSound(t).play()}return n}return u.sounds[e].play(t)};this.start=this.play;this.setPosition=function(e,t){return dt(e)?u.sounds[e].setPosition(t):!1};this.stop=function(e){if(!dt(e))return!1;u._wD(l+".stop("+e+")",1);return u.sounds[e].stop()};this.stopAll=function(){var e;u._wD(l+".stopAll()",1);for(e in u.sounds)u.sounds.hasOwnProperty(e)&&u.sounds[e].stop()};this.pause=function(e){return dt(e)?u.sounds[e].pause():!1};this.pauseAll=function(){var e;for(e=u.soundIDs.length-1;e>=0;e--)u.sounds[u.soundIDs[e]].pause()};this.resume=function(e){return dt(e)?u.sounds[e].resume():!1};this.resumeAll=function(){var e;for(e=u.soundIDs.length-1;e>=0;e--)u.sounds[u.soundIDs[e]].resume()};this.togglePause=function(e){return dt(e)?u.sounds[e].togglePause():!1};this.setPan=function(e,t){return dt(e)?u.sounds[e].setPan(t):!1};this.setVolume=function(e,t){return dt(e)?u.sounds[e].setVolume(t):!1};this.mute=function(e){var t=0;e instanceof String&&(e=null);if(!!e){if(!dt(e))return!1;u._wD(l+'.mute(): Muting "'+e+'"');return u.sounds[e].mute()}u._wD(l+".mute(): Muting all sounds");for(t=u.soundIDs.length-1;t>=0;t--)u.sounds[u.soundIDs[t]].mute();u.muted=!0;return!0};this.muteAll=function(){u.mute()};this.unmute=function(e){var t;e instanceof String&&(e=null);if(!!e){if(!dt(e))return!1;u._wD(l+'.unmute(): Unmuting "'+e+'"');return u.sounds[e].unmute()}u._wD(l+".unmute(): Unmuting all sounds");for(t=u.soundIDs.length-1;t>=0;t--)u.sounds[u.soundIDs[t]].unmute();u.muted=!1;return!0};this.unmuteAll=function(){u.unmute()};this.toggleMute=function(e){return dt(e)?u.sounds[e].toggleMute():!1};this.getMemoryUse=function(){var e=0;f&&w!==8&&(e=parseInt(f._getMemoryUse(),10));return e};this.disable=function(n){var r;n===t&&(n=!1);if(k)return!1;k=!0;A("shutdown",1);for(r=u.soundIDs.length-1;r>=0;r--)tt(u.sounds[u.soundIDs[r]]);M(n);_t.remove(e,"load",j);return!0};this.canPlayMIME=function(e){var t;u.hasHTML5&&(t=kt(
{type:e}));!t&&Tt&&(t=e&&u.ok()?!!((w>8?e.match(sn):null)||e.match(u.mimePattern)):null);return t};this.canPlayURL=function(e){var t;u.hasHTML5&&(t=kt({url:e}));!t&&Tt&&(t=e&&u.ok()?!!e.match(u.filePattern):null);return t};this.canPlayLink=function(e){return e.type!==t&&e.type&&u.canPlayMIME(e.type)?!0:u.canPlayURL(e.href)};this.getSoundById=function(e,t){var n;if(!e)throw new Error(l+".getSoundById(): sID is null/_undefined");n=u.sounds[e];!n&&!t&&u._wD('"'+e+'" is an invalid sound ID.',2);return n};this.onready=function(t,n){var r="onready",i=!1;if(typeof t!="function")throw ot("needFunction",r);C&&u._wD(ot("queue",r));n||(n=e);H(r,t,n);B();i=!0;return i};this.ontimeout=function(t,n){var r="ontimeout",i=!1;if(typeof t!="function")throw ot("needFunction",r);C&&u._wD(ot("queue",r));n||(n=e);H(r,t,n);B({type:r});i=!0;return i};this._writeDebug=function(e,n){var r,i,s="soundmanager-debug";if(!u.debugMode)return!1;if(Qt&&u.useConsole){n&&typeof n=="object"?console.log(e,n):Z[n]!==t?console[Z[n]](e):console.log(e);if(u.consoleOnly)return!0}r=p(s);if(!r)return!1;i=m.createElement("div");++O%2===0&&(i.className="sm2-alt");n===t?n=0:n=parseInt(n,10);i.appendChild(m.createTextNode(e));if(n){n>=2&&(i.style.fontWeight="bold");n===3&&(i.style.color="#ff3333")}r.insertBefore(i,r.firstChild);r=null;return!0};v.indexOf("sm2-debug=alert")!==-1&&(this._writeDebug=function(t){e.alert(t)});this._wD=this._writeDebug;this._debug=function(){var e,t;A("currentObj",1);for(e=0,t=u.soundIDs.length;e<t;e++)u.sounds[u.soundIDs[e]]._debug()};this.reboot=function(t,n){var r,i,s;u.soundIDs.length&&u._wD("Destroying "+u.soundIDs.length+" SMSound objects...");for(r=u.soundIDs.length-1;r>=0;r--)u.sounds[u.soundIDs[r]].destruct();if(f)try{Wt&&(st=f.innerHTML);it=f.parentNode.removeChild(f);A("flRemoved")}catch(o){A("badRemove",2)}st=it=Tt=f=null;u.enabled=$=C=vt=mt=T=N=k=Pt=u.swfLoaded=!1;u.soundIDs=[];u.sounds={};if(!t){for(r in E)if(E.hasOwnProperty(r))for(i=0,s=E[r].length;i<s;i++)E[r][i].fired=!1}else E=[];n||u._wD(l+": Rebooting...");u.html5={usingFlash:null};u.flash={};u.html5Only=!1;u.ignoreFlash=!1;e.setTimeout(function(){W();n||u.beginDelayedInit()},20);return u};this.reset=function(){A("reset");return u.reboot(!0,!0)};this.getMoviePercent=function(){return f&&"PercentLoaded"in f?f.PercentLoaded():null};this.beginDelayedInit=function(){L=!0;X();setTimeout(function(){if(mt)return!1;K();z();mt=!0;return!0},20);F()};this.destruct=function(){u._wD(l+".destruct()");u.disable(!0)};o=function(e){var n,r,i,s,o,l,c,h,p=this,d=!1,v=[],m=0,g=null,y={duration:null,time:null};this.id=e.id;this.sID=this.id;this.url=e.url;this.options=_(e);this.instanceOptions=this.options;this._iO=this.instanceOptions;this.pan=this.options.pan;this.volume=this.options.volume;this.isHTML5=!1;this._a=null;this.id3={};this._debug=function(){u._wD(p.id+": Merged options:",p.options)};this.load=function(e){var n,r=null;if(e!==t)p._iO=_(e,p.options);else{e=p.options;p._iO=e;if(g&&g!==p.url){A("manURL");p._iO.url=p.url;p.url=null}}p._iO.url||(p._iO.url=p.url);p._iO.url=St(p._iO.url);p.instanceOptions=p._iO;n=p._iO;u._wD(p.id+": load ("+n.url+")");if(n.url===p.url&&p.readyState!==0&&p.readyState!==2){A("onURL",1);p.readyState===3&&n.onload&&n.onload.apply(p,[!!p.duration]);return p}p.loaded=!1;p.readyState=1;p.playState=0;p.id3={};if(Ct(n)){r=p._setup_html5(n);if(!r._called_load){p._html5_canplay=!1;if(p.url!==n.url){u._wD(A("manURL")+": "+n.url);p._a.src=n.url;p.setPosition(0)}p._a.autobuffer="auto";p._a.preload="auto";p._a._called_load=!0;n.autoPlay&&p.play()}else u._wD(p.id+": Ignoring request to load again")}else try{p.isHTML5=!1;p._iO=ht(ct(n));n=p._iO;w===8?f._load(p.id,n.url,n.stream,n.autoPlay,n.usePolicyFile):f._load(p.id,n.url,!!n.stream,!!n.autoPlay,n.loops||1,!!n.autoLoad,n.usePolicyFile)}catch(i){A("smError",2);x("onload",!1);Q({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}p.url=n.url;return p};this.unload=function(){if(p.readyState!==0){u._wD(p.id+": unload()");if(!p.isHTML5)w===8?f._unload(p.id,tn):f._unload(p.id);else{s();if(p._a){p._a.pause();At(p._a,tn);g=tn}}n()}return p};this.destruct=function(e){u._wD(p.id+": Destruct");if(!p.isHTML5){p._iO.onfailure=null;f._destroySound(p.id)}else{s();if(p._a){p._a.pause();At(p._a);Pt||i();p._a._s=null;p._a=null}}e||u.destroySound(p.id,!0)};this.play=function(e,n){var r,i,s,a=!0,c=null,v=p.id+": play(): ";n=n===t?!0:n;e||(e={});p.url&&(p._iO.url=p.url);p._iO=_(p._iO,p.options);p._iO=_(e,p._iO);p._iO.url=St(p._iO.url);p.instanceOptions=p._iO;if(p._iO.serverURL&&!p.connected){if(!p.getAutoPlay()){u._wD(v+" Netstream not connected yet - setting autoPlay");p.setAutoPlay(!0)}return p}if(Ct(p._iO)){p._setup_html5(p._iO);o()}if(p.playState===1&&!p.paused){r=p._iO.multiShot;if(!r){u._wD(v+"Already playing (one-shot)",1);c=p}else u._wD(v+"Already playing (multi-shot)",1)}if(c!==null)return c;e.url&&e.url!==p.url&&p.load(p._iO);if(!p.loaded)if(p.readyState===0){u._wD(v+"Attempting to load");if(!p.isHTML5){p._iO.autoPlay=!0;p.load(p._iO)}else p.load(p._iO);p.instanceOptions=p._iO}else if(p.readyState===2){u._wD(v+"Could not load - exiting",2);c=p}else u._wD(v+"Loading - attempting to play...");else u._wD(v);if(c!==null)return c;if(!p.isHTML5&&w===9&&p.position>0&&p.position===p.duration){u._wD(v+"Sound at end, resetting to position:0");e.position=0}if(p.paused&&p.position>=0&&(!p._iO.serverURL||p.position>0)){u._wD(v+"Resuming from paused state",1);p.resume()}else{p._iO=_(e,p._iO);if(p._iO.from!==null&&p._iO.to!==null&&p.instanceCount===0&&p.playState===0&&!p._iO.serverURL){s=function(){p._iO=_(e,p._iO);p.play(p._iO)};if(p.isHTML5&&!p._html5_canplay){u._wD(v+"Beginning load for from/to case");p.load({oncanplay:s});c=!1}else if(!p.isHTML5&&!p.loaded&&(!p.readyState||p.readyState!==2)){u._wD(v+"Preloading for from/to case");p.load({onload:s});c=!1}if(c!==null)return c;p._iO=h()}u._wD(v+"Starting to play");(!p.instanceCount||p._iO.multiShotEvents||!p.isHTML5&&w>8&&!p.getAutoPlay())&&p.instanceCount++;p._iO.onposition&&p.playState===0&&l(p);p.playState=1;p.paused=!1;p.position=p._iO.position!==t&&!isNaN(p._iO.position)?p._iO.position:0;p.isHTML5||(p._iO=ht(ct(p._iO)));if(p._iO.onplay&&n){p._iO.onplay.apply(p);d=!0}p.setVolume(p._iO.volume,!0);p.setPan(p._iO.pan,!0);if(!p.isHTML5){a=f._start(p.id,p._iO.loops||1,w===9?p._iO.position:p._iO.position/1e3,p._iO.multiShot);if(w===9&&!a){u._wD(v+"No sound hardware, or 32-sound ceiling hit");p._iO.onplayerror&&p._iO.onplayerror.apply(p)}}else{o();i=p._setup_html5();p.setPosition(p._iO.position);i.play()}}return p};this.start=this.play;this.stop=function(e){var t,n=p._iO;if(p.playState===1){u._wD(p.id+": stop()");p._onbufferchange(0);p._resetOnPosition(0);p.paused=!1;p.isHTML5||(p.playState=0);c();n.to&&p.clearOnPosition(n.to);if(!p.isHTML5){f._stop(p.id,e);n.serverURL&&p.unload()}else if(p._a){t=p.position;p.setPosition(0);p.position=t;p._a.pause();p.playState=0;p._onTimer();s()}p.instanceCount=0;p._iO={};n.onstop&&n.onstop.apply(p)}return p};this.setAutoPlay=function(e){u._wD(p.id+": Autoplay turned "+(e?"on":"off"));p._iO.autoPlay=e;if(!p.isHTML5){f._setAutoPlay(p.id,e);if(e&&!p.instanceCount&&p.readyState===1){p.instanceCount++;u._wD(p.id+": Incremented instance count to "+p.instanceCount)}}};this.getAutoPlay=function(){return p._iO.autoPlay};this.setPosition=function(e){var n,r,i,s;e===t&&(e=0);s=p.isHTML5?Math.max(e,0):Math.min(p.duration||p._iO.duration,Math.max(e,0));n=p.position;p.position=s;i=p.position/1e3;p._resetOnPosition(p.position);p._iO.position=s;if(!p.isHTML5){r=w===9?p.position:i;p.readyState&&p.readyState!==2&&f._setPosition(p.id,r,p.paused||!p.playState,p._iO.multiShot)}else if(p._a)if(p._html5_canplay){if(p._a.currentTime!==i){u._wD(p.id+": setPosition("+i+")");try{p._a.currentTime=i;(p.playState===0||p.paused)&&p._a.pause()}catch(o){u._wD(p.id+": setPosition("+i+") failed: "+o.message,2)}}}else u._wD(p.id+": setPosition("+i+"): Cannot seek yet, sound not ready");p.isHTML5&&p.paused&&p._onTimer(!0);return p};this.pause=function(e){if(p.paused||p.playState===0&&p.readyState!==1)return p;u._wD(p.id+": pause()");p.paused=!0;if(!p.isHTML5)(e||e===t)&&f._pause(p.id,p._iO.multiShot);else{p._setup_html5().pause();s()}p._iO.onpause&&p._iO.onpause.apply(p);return p};this.resume=function(){var e=p._iO;if(!p.paused)return p;u._wD(p.id+": resume()");p.paused=!1;p.playState=1;if(!p.isHTML5){e.isMovieStar&&!e.serverURL&&p.setPosition(p.position);f._pause(p.id,e.multiShot)}else{p._setup_html5().play();o()}if(!d&&e.onplay){e.onplay.apply(p);d=!0}else e.onresume&&e.onresume.apply(p);return p};this.togglePause=function(){u._wD(p.id+": togglePause()");if(p.playState===0){p.play({position:w===9&&!p.isHTML5?p.position:p.position/1e3});return p}p.paused?p.resume():p.pause();return p};this.setPan=function(e,n){e===t&&(e=0);n===t&&(n=!1);p.isHTML5||f._setPan(p.id,e);p._iO.pan=e;if(!n){p.pan=e;p.options.pan=e}return p};this.setVolume=function(e,n){e===t&&(e=100);n===t&&(n=!1);p.isHTML5?p._a&&(p._a.volume=Math.max(0,Math.min(1,e/100))):f._setVolume(p.id,u.muted&&!p.muted||p.muted?0:e);p._iO.volume=e;if(!n){p.volume=e;p.options.volume=e}return p};this.mute=function(){p.muted=!0;p.isHTML5?p._a&&(p._a.muted=!0):f._setVolume(p.id,0);return p};this.unmute=function(){var e;p.muted=!1;e=p._iO.volume!==t;p.isHTML5?p._a&&(p._a.muted=!1):f._setVolume(p.id,e?p._iO.volume:p.options.volume);return p};this.toggleMute=function(){return p.muted?p.unmute():p.mute()};this.onPosition=function(e,n,r){v.push({position:parseInt(e,10),method:n,scope:r!==t?r:p,fired:!1});return p};this.onposition=this.onPosition;this.clearOnPosition=function(e,t){var n;e=parseInt(e,10);if(isNaN(e))return!1;for(n=0;n<v.length;n++)if(e===v[n].position)if(!t||t===v[n].method){v[n].fired&&m--;v.splice(n,1)}};this._processOnPosition=function(){var e,t,n=v.length;if(!n||!p.playState||m>=n)return!1;for(e=n-1;e>=0;e--){t=v[e];if(!t.fired&&p.position>=t.position){t.fired=!0;m++;t.method.apply(t.scope,[t.position])}}return!0};this._resetOnPosition=function(e){var t,n,r=v.length;if(!r)return!1;for(t=r-1;t>=0;t--){n=v[t];if(n.fired&&e<=n.position){n.fired=!1;m--}}return!0};h=function(){var e=p._iO,t=e.from,n=e.to,r=function(){u._wD(p.id+': "To" time of '+n+" reached.");p.clearOnPosition(n,r);p.stop()},i=function(){u._wD(p.id+': Playing "from" '+t);n!==null&&!isNaN(n)&&p.onPosition(n,r)};if(t!==null&&!isNaN(t)){e.position=t;e.multiShot=!1;i()}return e};l=function(){var e,t=p._iO.onposition;if(t)for(e in t)t.hasOwnProperty(e)&&p.onPosition(parseInt(e,10),t[e])};c=function(){var e,t=p._iO.onposition;if(t)for(e in t)t.hasOwnProperty(e)&&p.clearOnPosition(parseInt(e,10))};o=function(){p.isHTML5&&gt(p)};s=function(){p.isHTML5&&yt(p)};n=function(e){if(!e){v=[];m=0}d=!1;p._hasTimer=null;p._a=null;p._html5_canplay=!1;p.bytesLoaded=null;p.bytesTotal=null;p.duration=p._iO&&p._iO.duration?p._iO.duration:null;p.durationEstimate=null;p.buffered=[];p.eqData=[];p.eqData.left=[];p.eqData.right=[];p.failures=0;p.isBuffering=!1;p.instanceOptions={};p.instanceCount=0;p.loaded=!1;p.metadata={};p.readyState=0;p.muted=!1;p.paused=!1;p.peakData={left:0,right:0};p.waveformData={left:[],right:[]};p.playState=0;p.position=null;p.id3={}};n();this._onTimer=function(e){var t,n,r=!1,i={};if(p._hasTimer||e){if(p._a&&(e||(p.playState>0||p.readyState===1)&&!p.paused)){t=p._get_html5_duration();if(t!==y.duration){y.duration=t;p.duration=t;r=!0}p.durationEstimate=p.duration;n=p._a.currentTime*1e3||0;if(n!==y.time){y.time=n;r=!0}(r||e)&&p._whileplaying(n,i,i,i,i)}return r}};this._get_html5_duration=function(){var e=p._iO,t=p._a&&p._a.duration?p._a.duration*1e3:e&&e.duration?e.duration:null,n=t&&!isNaN(t)&&t!==Infinity?t:null;return n};this._apply_loop=function(e,t){!e.loop&&t>1&&u._wD("Note: Native HTML5 looping is infinite.",1);e.loop=t>1?"loop":""};this._setup_html5=function(e){var t,i=_(p._iO,e),s=decodeURI,o=Pt?a:p._a,u=s(i.url);Pt?u===Ht&&(t=!0):u===g&&(t=!0);if(o){if(o._s)if(Pt)o._s&&o._s.playState&&!t&&o._s.stop();else if(!Pt&&u===s(g)){p._apply_loop(o,i.loops);return o}if(!t){n(!1);o.src=i.url;p.url=i.url;g=i.url;Ht=i.url;o._called_load=!1}}else{i.autoLoad||i.autoPlay?p._a=new Audio(i.url):p._a=$t&&opera.version()<10?new Audio(null):new Audio;o=p._a;o._called_load=!1;Pt&&(a=o)}p.isHTML5=!0;p._a=o;o._s=p;r();p._apply_loop(o,i.loops);if(i.autoLoad||i.autoPlay)p.load();else{o.autobuffer=!1;o.preload="auto"}return o};r=function(){function e(e,t,n){return p._a?p._a.addEventListener(e,t,n||!1):null}var t;if(p._a._added_events)return!1;p._a._added_events=!0;for(t in It)It.hasOwnProperty(t)&&e(t,It[t]);return!0};i=function(){function e(e,t,n){return p._a?p._a.removeEventListener(e,t,n||!1):null}var t;u._wD(p.id+": Removing event listeners");p._a._added_events=!1;for(t in It)It.hasOwnProperty(t)&&e(t,It[t])};this._onload=function(e){var t=!!e||!p.isHTML5&&w===8&&p.duration,n=p.id+": ";u._wD(n+(t?"onload()":"Failed to load? - "+p.url),t?1:2);if(!t&&!p.isHTML5){u.sandbox.noRemote===!0&&u._wD(n+ot("noNet"),1);u.sandbox.noLocal===!0&&u._wD(n+ot("noLocal"),1)}p.loaded=t;p.readyState=t?3:2;p._onbufferchange(0);p._iO.onload&&p._iO.onload.apply(p,[t]);return!0};this._onbufferchange=function(e){if(p.playState===0)return!1;if(e&&p.isBuffering||!e&&!p.isBuffering)return!1;p.isBuffering=e===1;if(p._iO.onbufferchange){u._wD(p.id+": Buffer state change: "+e);p._iO.onbufferchange.apply(p)}return!0};this._onsuspend=function(){if(p._iO.onsuspend){u._wD(p.id+": Playback suspended");p._iO.onsuspend.apply(p)}return!0};this._onfailure=function(e,t,n){p.failures++;u._wD(p.id+": Failures = "+p.failures);p._iO.onfailure&&p.failures===1?p._iO.onfailure(p,e,t,n):u._wD(p.id+": Ignoring failure")};this._onfinish=function(){var e=p._iO.onfinish;p._onbufferchange(0);p._resetOnPosition(0);if(p.instanceCount){p.instanceCount--;if(!p.instanceCount){c();p.playState=0;p.paused=!1;p.instanceCount=0;p.instanceOptions={};p._iO={};s();p.isHTML5&&(p.position=0)}if(!p.instanceCount||p._iO.multiShotEvents)if(e){u._wD(p.id+": onfinish()");e.apply(p)}}};this._whileloading=function(e,t,n,r){var i=p._iO;p.bytesLoaded=e;p.bytesTotal=t;p.duration=Math.floor(n);p.bufferLength=r;!p.isHTML5&&!i.isMovieStar?i.duration?p.durationEstimate=p.duration>i.duration?p.duration:i.duration:p.durationEstimate=parseInt(p.bytesTotal/p.bytesLoaded*p.duration,10):p.durationEstimate=p.duration;p.isHTML5||(p.buffered=[{start:0,end:p.duration}]);(p.readyState!==3||p.isHTML5)&&i.whileloading&&i.whileloading.apply(p)};this._whileplaying=function(e,n,r,i,s){var o,u=p._iO;if(isNaN(e)||e===null)return!1;p.position=Math.max(0,e);p._processOnPosition();if(!p.isHTML5&&w>8){u.usePeakData&&n!==t&&n&&(p.peakData={left:n.leftPeak,right:n.rightPeak});u.useWaveformData&&r!==t&&r&&(p.waveformData={left:r.split(","),right:i.split(",")});if(u.useEQData&&s!==t&&s&&s.leftEQ){o=s.leftEQ.split(",");p.eqData=o;p.eqData.left=o;s.rightEQ!==t&&s.rightEQ&&(p.eqData.right=s.rightEQ.split(","))}}if(p.playState===1){!p.isHTML5&&w===8&&!p.position&&p.isBuffering&&p._onbufferchange(0);u.whileplaying&&u.whileplaying.apply(p)}return!0};this._oncaptiondata=function(e){u._wD(p.id+": Caption data received.");p.captiondata=e;p._iO.oncaptiondata&&p._iO.oncaptiondata.apply(p,[e])};this._onmetadata=function(e,t){var n,r,i;u._wD(p.id+": Metadata received.");n={};for(r=0,i=e.length;r<i;r++)n[e[r]]=t[r];p.metadata=n;p._iO.onmetadata&&p._iO.onmetadata.apply(p)};this._onid3=function(e,t){var n,r,i;u._wD(p.id+": ID3 data received.");n=[];for(r=0,i=e.length;r<i;r++)n[e[r]]=t[r];p.id3=_(p.id3,n);p._iO.onid3&&p._iO.onid3.apply(p)};this._onconnect=function(e){e=e===1;u._wD(p.id+": "+(e?"Connected.":"Failed to connect? - "+p.url),e?1:2);p.connected=e;if(e){p.failures=0;dt(p.id)&&(p.getAutoPlay()?p.play(t,p.getAutoPlay()):p._iO.autoLoad&&p.load());p._iO.onconnect&&p._iO.onconnect.apply(p,[e])}};this._ondataerror=function(e){if(p.playState>0){u._wD(p.id+": Data error: "+e);p._iO.ondataerror&&p._iO.ondataerror.apply(p)}};this._debug()};J=function(){return m.body||m._docElement||m.getElementsByTagName("div")[0]};p=function(e){return m.getElementById(e)};_=function(e,n){var r,i=e||{},s=n===t?u.defaultOptions:n;for(r in s)s.hasOwnProperty(r)&&i[r]===t&&(typeof s[r]!="object"||s[r]===null?i[r]=s[r]:i[r]=_(i[r],s[r]));return i};P={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1};D=function(e,n){var r,i=!0,s=n!==t,o=u.setupOptions,a=P;if(e===t){i=[];for(r in o)o.hasOwnProperty(r)&&i.push(r);for(r in a)a.hasOwnProperty(r)&&(typeof u[r]=="object"?i.push(r+": {...}"):u[r]instanceof Function?i.push(r+": function() {...}"):i.push(r));u._wD(ot("setup",i.join(", ")));return!1}for(r in e)if(e.hasOwnProperty(r))if(typeof e[r]!="object"||e[r]===null||e[r]instanceof Array||e[r]instanceof RegExp)if(s&&a[n]!==t)u[n][r]=e[r];else if(o[r]!==t){u.setupOptions[r]=e[r];u[r]=e[r]}else if(a[r]===t){pt(ot(u[r]===t?"setupUndef":"setupError",r),2);i=!1}else u[r]instanceof Function?u[r].apply(u,e[r]instanceof Array?e[r]:[e[r]]):u[r]=e[r];else{if(a[r]!==t)return D(e[r],r);pt(ot(u[r]===t?"setupUndef":"setupError",r),2);i=!1}return i};_t=function(){function t(e){var t=Dt.call(e),n=t.length;if(s){t[1]="on"+t[1];n>3&&t.pop()}else n===3&&t.push(!1);return t}function n(e,t){var n=e.shift(),r=[o[t]];s?n[r](e[0],e[1]):n[r].apply(n,e)}function r(){n(t(arguments),"add")}function i(){n(t(arguments),"remove")}var s=e.attachEvent,o={add:s?"attachEvent":"addEventListener",remove:s?"detachEvent":"removeEventListener"};return{add:r,remove:i}}();It={abort:s(function(){u._wD(this._s.id+": abort")}),canplay:s(function(){var e,n=this._s;if(n._html5_canplay)return!0;n._html5_canplay=!0;u._wD(n.id+": canplay");n._onbufferchange(0);e=n._iO.position!==t&&!isNaN(n._iO.position)?n._iO.position/1e3:null;if(n.position&&this.currentTime!==e){u._wD(n.id+": canplay: Setting position to "+e);try{this.currentTime=e}catch(r){u._wD(n.id+": canplay: Setting position of "+e+" failed: "+r.message,2)}}n._iO._oncanplay&&n._iO._oncanplay()}),canplaythrough:s(function(){var e=this._s;if(!e.loaded){e._onbufferchange(0);e._whileloading(e.bytesLoaded,e.bytesTotal,e._get_html5_duration());e._onload(!0)}}),ended:s(function(){var e=this._s;u._wD(e.id+": ended");e._onfinish()}),error:s(function(){u._wD(this._s.id+": HTML5 error, code "+this.error.code);this._s._onload(!1)}),loadeddata:s(function(){var e=this._s;u._wD(e.id+": loadeddata");!e._loaded&&!Vt&&(e.duration=e._get_html5_duration())}),loadedmetadata:s(function(){u._wD(this._s.id+": loadedmetadata")}),loadstart:s(function(){u._wD(this._s.id+": loadstart");this._s._onbufferchange(1)}),play:s(function(){u._wD(this._s.id+": play()");this._s._onbufferchange(0)}),playing:s(function(){u._wD(this._s.id+": playing");this._s._onbufferchange(0)}),progress:s(function(e){var t,n,r,i=this._s,s=0,o=e.type==="progress",a=e.target.buffered,f=e.loaded||0,l=e.total||1,c=1e3;i.buffered=[];if(a&&a.length){for(t=0,n=a.length;t<n;t++)i.buffered.push({start:a.start(t)*c,end:a.end(t)*c});s=(a.end(0)-a.start(0))*c;f=s/(e.target.duration*c);if(o&&a.length>1){r=[];n=a.length;for(t=0;t<n;t++)r.push(e.target.buffered.start(t)*c+"-"+e.target.buffered.end(t)*c);u._wD(this._s.id+": progress, timeRanges: "+r.join(", "))}o&&!isNaN(f)&&u._wD(this._s.id+": progress, "+Math.floor(f*100)+"% loaded")}if(!isNaN(f)){i._onbufferchange(0);i._whileloading(f,l,i._get_html5_duration());f&&l&&f===l&&It.canplaythrough.call(this,e)}}),ratechange:s(function(){u._wD(this._s.id+": ratechange")}),suspend:s(function(e){var t=this._s;u._wD(this._s.id+": suspend");It.progress.call(this,e);t._onsuspend()}),stalled:s(function(){u._wD(this._s.id+": stalled")}),timeupdate:s(function(){this._s._onTimer()}),waiting:s(function(){var e=this._s;u._wD(this._s.id+": waiting");e._onbufferchange(1)})};Ct=function(e){var t;e.serverURL||e.type&&i(e.type)?t=!1:t=e.type?kt({type:e.type}):kt({url:e.url})||u.html5Only;return t};At=function(e,t){if(e){e.src=t;e._called_load=!1}Pt&&(Ht=null)};kt=function(e){var n,r,s,o,a,f,l;if(!u.useHTML5Audio||!u.hasHTML5)return!1;n=e.url||null,r=e.type||null,s=u.audioFormats;if(r&&u.html5[r]!==t)return u.html5[r]&&!i(r);if(!Lt){Lt=[];for(l in s)if(s.hasOwnProperty(l)){Lt.push(l);s[l].related&&(Lt=Lt.concat(s[l].related))}Lt=new RegExp("\\.("+Lt.join("|")+")(\\?.*)?$","i")}f=n?n.toLowerCase().match(Lt):null;if(!f||!f.length)if(!r)o=!1;else{a=r.indexOf(";");f=(a!==-1?r.substr(0,a):r).substr(6)}else f=f[1];if(f&&u.html5[f]!==t)o=u.html5[f]&&!i(f);else{r="audio/"+f;o=u.html5.canPlayType({type:r});u.html5[f]=o;o=o&&u.html5[r]&&!i(r)}return o};Mt=function(){function e(e){var t,r,i,s=!1,o=!1;if(!n||typeof n.canPlayType!="function")return s;if(e instanceof Array){for(r=0,i=e.length;r<i;r++)if(u.html5[e[r]]||n.canPlayType(e[r]).match(u.html5Test)){o=!0;u.html5[e[r]]=!0;u.flash[e[r]]=!!e[r].match(en)}s=o}else{t=n&&typeof n.canPlayType=="function"?n.canPlayType(e):!1;s=!!t&&!!t.match(u.html5Test)}return s}var n,r,i,s,o,a;if(!u.useHTML5Audio||!u.hasHTML5)return!1;n=Audio!==t?$t&&opera.version()<10?new Audio(null):new Audio:null,s={};o=u.audioFormats;for(r in o)if(o.hasOwnProperty(r)){i="audio/"+r;s[r]=e(o[r].type);s[i]=s[r];if(r.match(en)){u.flash[r]=!0;u.flash[i]=!0}else{u.flash[r]=!1;u.flash[i]=!1}if(o[r]&&o[r].related)for(a=o[r].related.length-1;a>=0;a--){s["audio/"+o[r].related[a]]=s[r];u.html5[o[r].related[a]]=s[r];u.flash[o[r].related[a]]=s[r]}}s.canPlayType=n?e:null;u.html5=_(u.html5,s);return!0};U={notReady:"Unavailable - wait until onready() has fired.",notOK:"Audio support is not available.",domError:l+"exception caught while appending SWF to DOM.",spcWmode:"Removing wmode, preventing known SWF loading issue(s)",swf404:c+"Verify that %s is a valid path.",tryDebug:"Try "+l+".debugFlash = true for more security details (output goes to SWF.)",checkSWF:"See SWF output for more debug info.",localFail:c+"Non-HTTP page ("+m.location.protocol+" URL?) Review Flash player security settings for this special case:\nhttp://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html\nMay need to add/allow path, eg. c:/sm2/ or /users/me/sm2/",waitFocus:c+"Special case: Waiting for SWF to load with window focus...",waitForever:c+"Waiting indefinitely for Flash (will recover if unblocked)...",waitSWF:c+"Waiting for 100% SWF load...",needFunction:c+"Function object expected for %s",badID:'Warning: Sound ID "%s" should be a string, starting with a non-numeric character',currentObj:c+"_debug(): Current sound objects",waitOnload:c+"Waiting for window.onload()",docLoaded:c+"Document already loaded",onload:c+"initComplete(): calling soundManager.onload()",onloadOK:l+".onload() complete",didInit:c+"init(): Already called?",secNote:"Flash security note: Network/internet URLs will not load due to security restrictions. Access can be configured via Flash Player Global Security Settings Page: http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html",badRemove:c+"Failed to remove Flash node.",shutdown:l+".disable(): Shutting down",queue:c+"Queueing %s handler",smError:"SMSound.load(): Exception: JS-Flash communication failed, or JS error.",fbTimeout:"No flash response, applying ."+ft.swfTimedout+" CSS...",fbLoaded:"Flash loaded",flRemoved:c+"Flash movie removed.",fbHandler:c+"flashBlockHandler()",manURL:"SMSound.load(): Using manually-assigned URL",onURL:l+".load(): current URL already assigned.",badFV:l+'.flashVersion must be 8 or 9. "%s" is invalid. Reverting to %s.',as2loop:"Note: Setting stream:false so looping can work (flash 8 limitation)",noNSLoop:"Note: Looping not implemented for MovieStar formats",needfl9:"Note: Switching to flash 9, required for MP4 formats.",mfTimeout:"Setting flashLoadTimeout = 0 (infinite) for off-screen, mobile flash case",needFlash:c+"Fatal error: Flash is needed to play some required formats, but is not available.",gotFocus:c+"Got window focus.",policy:"Enabling usePolicyFile for data access",setup:l+".setup(): allowed parameters: %s",setupError:l+'.setup(): "%s" cannot be assigned with this method.',setupUndef:l+'.setup(): Could not find option "%s"',setupLate:l+".setup(): url, flashVersion and html5Test property changes will not take effect until reboot().",noURL:c+"Flash URL required. Call soundManager.setup({url:...}) to get started.",sm2Loaded:"SoundManager 2: Ready.",reset:l+".reset(): Removing event callbacks",mobileUA:"Mobile UA detected, preferring HTML5 by default.",globalHTML5:"Using singleton HTML5 Audio() pattern for this device."};ot=function(){var e,t,n=Dt.call(arguments),r=n.shift(),i=U&&U[r]?U[r]:"";if(i&&n&&n.length)for(e=0,t=n.length;e<t;e++)i=i.replace("%s",n[e]);return i};ct=function(e){if(w===8&&e.loops>1&&e.stream){A("as2loop");e.stream=!1}return e};ht=function(e,t){if(e&&!e.usePolicyFile&&(e.onid3||e.usePeakData||e.useWaveformData||e.useEQData)){u._wD((t||"")+ot("policy"));e.usePolicyFile=!0}return e};pt=function(e){console!==t&&console.warn!==t?console.warn(e):u._wD(e)};g=function(){return!1};tt=function(e){var t;for(t in e)e.hasOwnProperty(t)&&typeof e[t]=="function"&&(e[t]=g);t=null};nt=function(e){e===t&&(e=!1);(k||e)&&u.disable(e)};rt=function(e){var t,n=null;if(e)if(e.match(/\.swf(\?.*)?$/i)){n=e.substr(e.toLowerCase().lastIndexOf(".swf?")+4);if(n)return e}else e.lastIndexOf("/")!==e.length-1&&(e+="/");t=(e&&e.lastIndexOf("/")!==-1?e.substr(0,e.lastIndexOf("/")+1):"./")+u.movieURL;u.noSWFCache&&(t+="?ts="+(new Date).getTime());return t};q=function(){var e;w=parseInt(u.flashVersion,10);if(w!==8&&w!==9){u._wD(ot("badFV",w,et));u.flashVersion=w=et}e=u.debugMode||u.debugFlash?"_debug.swf":".swf";if(u.useHTML5Audio&&!u.html5Only&&u.audioFormats.mp4.required&&w<9){u._wD(ot("needfl9"));u.flashVersion=w=9}u.version=u.versionNumber+(u.html5Only?" (HTML5-only mode)":w===9?" (AS3/Flash 9)":" (AS2/Flash 8)");if(w>8){u.defaultOptions=_(u.defaultOptions,u.flash9Options);u.features.buffering=!0;u.defaultOptions=_(u.defaultOptions,u.movieStarOptions);u.filePatterns.flash9=new RegExp("\\.(mp3|"+on.join("|")+")(\\?.*)?$","i");u.features.movieStar=!0}else u.features.movieStar=!1;u.filePattern=u.filePatterns[w!==8?"flash9":"flash8"];u.movieURL=(w===8?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",e);u.features.peakData=u.features.waveformData=u.features.eqData=w>8};G=function(e,t){if(!f)return!1;f._setPolling(e,t)};Y=function(){var e,t,n,r,i;u.debugURLParam.test(v)&&(u.debugMode=!0);if(p(u.debugID))return!1;if(u.debugMode&&!p(u.debugID)&&(!Qt||!u.useConsole||!u.consoleOnly)){e=m.createElement("div");e.id=u.debugID+"-toggle";r={position:"fixed",bottom:"0px",right:"0px",width:"1.2em",height:"1.2em",lineHeight:"1.2em",margin:"2px",textAlign:"center",border:"1px solid #999",cursor:"pointer",background:"#fff",color:"#333",zIndex:10001};e.appendChild(m.createTextNode("-"));e.onclick=lt;e.title="Toggle SM2 debug console";if(d.match(/msie 6/i)){e.style.position="absolute";e.style.cursor="hand"}for(i in r)r.hasOwnProperty(i)&&(e.style[i]=r[i]);t=m.createElement("div");t.id=u.debugID;t.style.display=u.debugMode?"block":"none";if(u.debugMode&&!p(e.id)){try{n=J();n.appendChild(e)}catch(s){throw new Error(ot("domError")+" \n"+s.toString())}n.appendChild(t)}}n=null};dt=this.getSoundById;A=function(e,t){return e?u._wD(ot(e),t):""};lt=function(){var e=p(u.debugID),t=p(u.debugID+"-toggle");if(!e)return!1;if(S){t.innerHTML="+";e.style.display="none"}else{t.innerHTML="-";e.style.display="block"}S=!S};x=function(n,r,i){if(e.sm2Debugger!==t)try{sm2Debugger.handleEvent(n,r,i)}catch(s){}return!0};at=function(){var e=[];u.debugMode&&e.push(ft.sm2Debug);u.debugFlash&&e.push(ft.flashDebug);u.useHighPerformance&&e.push(ft.highPerf);return e.join(" ")};ut=function(){var e=ot("fbHandler"),t=u.getMoviePercent(),n=ft,r={type:"FLASHBLOCK"};if(u.html5Only)return!1;if(!u.ok()){if(Tt){u.oMC.className=at()+" "+n.swfDefault+" "+(t===null?n.swfTimedout:n.swfError);u._wD(e+": "+ot("fbTimeout")+(t?" ("+ot("fbLoaded")+")":""))}u.didFlashBlock=!0;B({type:"ontimeout",ignoreInit:!0,error:r});Q(r)}else{u.didFlashBlock&&u._wD(e+": Unblocked");u.oMC&&(u.oMC.className=[at(),n.swfDefault,n.swfLoaded+(u.didFlashBlock?" "+n.swfUnblocked:"")].join(" "))}};H=function(e,n,r){E[e]===t&&(E[e]=[]);E[e].push({method:n,scope:r||null,fired:!1})};B=function(e){var t,n,r,i,s,o,a;e||(e={type:u.ok()?"onready":"ontimeout"});if(!C&&e&&!e.ignoreInit)return!1;if(e.type==="ontimeout"&&(u.ok()||k&&!e.ignoreInit))return!1;t={success:e&&e.ignoreInit?u.ok():!k},n=e&&e.type?E[e.type]||[]:[],r=[],o=[t],a=Tt&&!u.ok();e.error&&(o[0].error=e.error);for(i=0,s=n.length;i<s;i++)n[i].fired!==!0&&r.push(n[i]);if(r.length)for(i=0,s=r.length;i<s;i++){r[i].scope?r[i].method.apply(r[i].scope,o):r[i].method.apply(this,o);a||(r[i].fired=!0)}return!0};j=function(){e.setTimeout(function(){u.useFlashBlock&&ut();B();if(typeof u.onload=="function"){A("onload",1);u.onload.apply(e);A("onloadOK",1)}u.waitForWindowLoad&&_t.add(e,"load",j)},1)};jt=function(){var n,r,i,s,o,u,a;if(Bt!==t)return Bt;n=!1,r=navigator,i=r.plugins,a=e.ActiveXObject;if(i&&i.length){o="application/x-shockwave-flash";u=r.mimeTypes;u&&u[o]&&u[o].enabledPlugin&&u[o].enabledPlugin.description&&(n=!0)}else if(a!==t&&!d.match(/MSAppHost/i)){try{s=new a("ShockwaveFlash.ShockwaveFlash")}catch(f){}n=!!s;s=null}Bt=n;return n};Nt=function(){var e,t,n=!0,r=u.audioFormats,i=Ut&&!!d.match(/os (1|2|3_0|3_1)/i);if(i){u.hasHTML5=!1;u.html5Only=!0;u.oMC&&(u.oMC.style.display="none");n=!1}else if(u.useHTML5Audio){if(!u.html5||!u.html5.canPlayType){u._wD("SoundManager: No HTML5 Audio() support detected.");u.hasHTML5=!1}Kt&&u._wD(c+"Note: Buggy HTML5 Audio in Safari on this OS X release, see https://bugs.webkit.org/show_bug.cgi?id=32159 - "+(Bt?"will use flash fallback for MP3/MP4, if available":" would use flash fallback for MP3/MP4, but none detected."),1)}if(u.useHTML5Audio&&u.hasHTML5)for(t in r)r.hasOwnProperty(t)&&(r[t].required&&!u.html5.canPlayType(r[t].type)||u.preferFlash&&(u.flash[t]||u.flash[r[t].type]))&&(e=!0);u.ignoreFlash&&(e=!1);u.html5Only=u.hasHTML5&&u.useHTML5Audio&&!e;return!u.html5Only};St=function(e){var t,n,r,i=0;if(e instanceof Array){for(t=0,n=e.length;t<n;t++)if(e[t]instanceof Object){if(u.canPlayMIME(e[t].type)){i=t;break}}else if(u.canPlayURL(e[t])){i=t;break}e[i].url&&(e[i]=e[i].url);r=e[i]}else r=e;return r};gt=function(t){if(!t._hasTimer){t._hasTimer=!0;if(!Jt&&u.html5PollingInterval){Et===null&&wt===0&&(Et=e.setInterval(bt,u.html5PollingInterval));wt++}}};yt=function(e){if(e._hasTimer){e._hasTimer=!1;!Jt&&u.html5PollingInterval&&wt--}};bt=function(){var t;if(Et!==null&&!wt){e.clearInterval(Et);Et=null;return!1}for(t=u.soundIDs.length-1;t>=0;t--)u.sounds[u.soundIDs[t]].isHTML5&&u.sounds[u.soundIDs[t]]._hasTimer&&u.sounds[u.soundIDs[t]]._onTimer()};Q=function(n){n=n!==t?n:{};typeof u.onerror=="function"&&u.onerror.apply(e,[{type:n.type!==t?n.type:null}]);n.fatal!==t&&n.fatal&&u.disable()};Ft=function(){var e,t,n;if(!Kt||!jt())return!1;e=u.audioFormats;for(n in e)if(e.hasOwnProperty(n))if(n==="mp3"||n==="mp4"){u._wD(l+": Using flash fallback for "+n+" format");u.html5[n]=!1;if(e[n]&&e[n].related)for(t=e[n].related.length-1;t>=0;t--)u.html5[e[n].related[t]]=!1}};this._setSandboxType=function(e){var n=u.sandbox;n.type=e;n.description=n.types[n.types[e]!==t?e:"unknown"];if(n.type==="localWithFile"){n.noRemote=!0;n.noLocal=!1;A("secNote",2)}else if(n.type==="localWithNetwork"){n.noRemote=!1;n.noLocal=!0}else if(n.type==="localTrusted"){n.noRemote=!1;n.noLocal=!1}};this._externalInterfaceOK=function(e,t){var n;if(u.swfLoaded)return!1;x("swf",!0);x("flashtojs",!0);u.swfLoaded=!0;Yt=!1;Kt&&Ft();if(!t||t.replace(/\+dev/i,"")!==u.versionNumber.replace(/\+dev/i,"")){n=l+': Fatal: JavaScript file build "'+u.versionNumber+'" does not match Flash SWF build "'+t+'" at '+u.url+". Ensure both are up-to-date.";setTimeout(function(){throw new Error(n)},0);return!1}setTimeout(b,Wt?100:1)};K=function(e,n){function r(){var e=[],t=[],n=" + ",r="SoundManager "+u.version+(!u.html5Only&&u.useHTML5Audio?u.hasHTML5?" + HTML5 audio":", no HTML5 audio support":"");if(!u.html5Only){u.preferFlash&&e.push("preferFlash");u.useHighPerformance&&e.push("useHighPerformance");u.flashPollingInterval&&e.push("flashPollingInterval ("+u.flashPollingInterval+"ms)");u.html5PollingInterval&&e.push("html5PollingInterval ("+u.html5PollingInterval+"ms)");u.wmode&&e.push("wmode ("+u.wmode+")");u.debugFlash&&e.push("debugFlash");u.useFlashBlock&&e.push("flashBlock")}else u.html5PollingInterval&&e.push("html5PollingInterval ("+u.html5PollingInterval+"ms)");e.length&&(t=t.concat([e.join(n)]));u._wD(r+(t.length?n+t.join(", "):""),1);qt()}function i(e,t){return'<param name="'+e+'" value="'+t+'" />'}var s,o,a,f,l,c,h,v,g,y,w,E,S,x,C;if(T&&N)return!1;if(u.html5Only){q();r();u.oMC=p(u.movieID);b();T=!0;N=!0;return!1}s=n||u.url,o=u.altURL||s,a="JS/Flash audio component (SoundManager 2)"
,f=J(),l=at(),c=null,h=m.getElementsByTagName("html")[0];c=h&&h.dir&&h.dir.match(/rtl/i);e=e===t?u.id:e;q();u.url=rt(nn?s:o);n=u.url;u.wmode=!u.wmode&&u.useHighPerformance?"transparent":u.wmode;if(u.wmode!==null&&(d.match(/msie 8/i)||!Wt&&!u.useHighPerformance)&&navigator.platform.match(/win32|win64/i)){xt.push(U.spcWmode);u.wmode=null}v={name:e,id:e,src:n,quality:"high",allowScriptAccess:u.allowScriptAccess,bgcolor:u.bgColor,pluginspage:rn+"www.macromedia.com/go/getflashplayer",title:a,type:"application/x-shockwave-flash",wmode:u.wmode,hasPriority:"true"};u.debugFlash&&(v.FlashVars="debug=1");u.wmode||delete v.wmode;if(Wt){g=m.createElement("div");w=['<object id="'+e+'" data="'+n+'" type="'+v.type+'" title="'+v.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+rn+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',i("movie",n),i("AllowScriptAccess",u.allowScriptAccess),i("quality",v.quality),u.wmode?i("wmode",u.wmode):"",i("bgcolor",u.bgColor),i("hasPriority","true"),u.debugFlash?i("FlashVars",v.FlashVars):"","</object>"].join("")}else{g=m.createElement("embed");for(y in v)v.hasOwnProperty(y)&&g.setAttribute(y,v[y])}Y();l=at();f=J();if(f){u.oMC=p(u.movieID)||m.createElement("div");if(!u.oMC.id){u.oMC.id=u.movieID;u.oMC.className=ft.swfDefault+" "+l;S=null;E=null;if(!u.useFlashBlock)if(u.useHighPerformance)S={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"};else{S={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"};c&&(S.left=Math.abs(parseInt(S.left,10))+"px")}Xt&&(u.oMC.style.zIndex=1e4);if(!u.debugFlash)for(x in S)S.hasOwnProperty(x)&&(u.oMC.style[x]=S[x]);try{Wt||u.oMC.appendChild(g);f.appendChild(u.oMC);if(Wt){E=u.oMC.appendChild(m.createElement("div"));E.className=ft.swfBox;E.innerHTML=w}N=!0}catch(k){throw new Error(ot("domError")+" \n"+k.toString())}}else{C=u.oMC.className;u.oMC.className=(C?C+" ":ft.swfDefault)+(l?" "+l:"");u.oMC.appendChild(g);if(Wt){E=u.oMC.appendChild(m.createElement("div"));E.className=ft.swfBox;E.innerHTML=w}N=!0}}T=!0;r();return!0};z=function(){if(u.html5Only){K();return!1}if(f)return!1;if(!u.url){A("noURL");return!1}f=u.getMovie(u.id);if(!f){if(!it)K(u.id,u.url);else{Wt?u.oMC.innerHTML=st:u.oMC.appendChild(it);it=null;T=!0}f=u.getMovie(u.id)}typeof u.oninitmovie=="function"&&setTimeout(u.oninitmovie,1);Rt();return!0};F=function(){setTimeout(I,1e3)};I=function(){var t,n=!1;if(!u.url)return!1;if(vt)return!1;vt=!0;_t.remove(e,"load",F);if(Yt&&!Gt){A("waitFocus");return!1}if(!C){t=u.getMoviePercent();t>0&&t<100&&(n=!0)}setTimeout(function(){t=u.getMoviePercent();if(n){vt=!1;u._wD(ot("waitSWF"));e.setTimeout(F,1);return!1}if(!C){u._wD(l+": No Flash response within expected time. Likely causes: "+(t===0?"SWF load failed, ":"")+"Flash blocked or JS-Flash security error."+(u.debugFlash?" "+ot("checkSWF"):""),2);if(!nn&&t){A("localFail",2);u.debugFlash||A("tryDebug",2)}t===0&&u._wD(ot("swf404",u.url),1);x("flashtojs",!1,": Timed out"+nn?" (Check flash security or flash blockers)":" (No plugin/missing SWF?)")}if(!C&&Zt)if(t===null)if(u.useFlashBlock||u.flashLoadTimeout===0){u.useFlashBlock&&ut();A("waitForever")}else{A("waitForever");B({type:"ontimeout",ignoreInit:!0})}else u.flashLoadTimeout===0?A("waitForever"):nt(!0)},u.flashLoadTimeout)};R=function(){function t(){_t.remove(e,"focus",R)}if(Gt||!Yt){t();return!0}Zt=!0;Gt=!0;A("gotFocus");vt=!1;F();t();return!0};Rt=function(){if(xt.length){u._wD("SoundManager 2: "+xt.join(" "),1);xt=[]}};qt=function(){var e,t;Rt();t=[];if(u.useHTML5Audio&&u.hasHTML5){for(e in u.audioFormats)u.audioFormats.hasOwnProperty(e)&&t.push(e+" = "+u.html5[e]+(!u.html5[e]&&Bt&&u.flash[e]?" (using flash)":u.preferFlash&&u.flash[e]&&Bt?" (preferring flash)":u.html5[e]?"":" ("+(u.audioFormats[e].required?"required, ":"")+"and no flash support)"));u._wD("SoundManager 2 HTML5 support: "+t.join(", "),1)}};M=function(t){var n,r,i;if(C)return!1;if(u.html5Only){A("sm2Loaded");C=!0;j();x("onload",!0);return!0}n=u.useFlashBlock&&u.flashLoadTimeout&&!u.getMoviePercent(),r=!0;if(!n){C=!0;k&&(i={type:!Bt&&Tt?"NO_FLASH":"INIT_TIMEOUT"})}u._wD("SoundManager 2 "+(k?"failed to load":"loaded")+" ("+(k?"Flash security/load error":"OK")+")",k?2:1);if(k||t){u.useFlashBlock&&u.oMC&&(u.oMC.className=at()+" "+(u.getMoviePercent()===null?ft.swfTimedout:ft.swfError));B({type:"ontimeout",error:i,ignoreInit:!0});x("onload",!1);Q(i);r=!1}else x("onload",!0);if(!k)if(u.waitForWindowLoad&&!L){A("waitOnload");_t.add(e,"load",j)}else{u.waitForWindowLoad&&L&&A("docLoaded");j()}return r};y=function(){var e,n=u.setupOptions;for(e in n)n.hasOwnProperty(e)&&(u[e]===t?u[e]=n[e]:u[e]!==n[e]&&(u.setupOptions[e]=u[e]))};b=function(){function t(){_t.remove(e,"load",u.beginDelayedInit)}if(C){A("didInit");return!1}if(u.html5Only){if(!C){t();u.enabled=!0;M()}return!0}z();try{f._externalInterfaceTest(!1);G(!0,u.flashPollingInterval||(u.useHighPerformance?10:50));u.debugMode||f._disableDebug();u.enabled=!0;x("jstoflash",!0);u.html5Only||_t.add(e,"unload",g)}catch(n){u._wD("js/flash exception: "+n.toString());x("jstoflash",!1);Q({type:"JS_TO_FLASH_EXCEPTION",fatal:!0});nt(!0);M();return!1}M();t();return!0};X=function(){if($)return!1;$=!0;y();Y();(function(){var n="sm2-usehtml5audio=",r="sm2-preferflash=",i=null,s=null,o=e.console!==t&&typeof console.log=="function",a=v.toLowerCase();if(a.indexOf(n)!==-1){i=a.charAt(a.indexOf(n)+n.length)==="1";o&&console.log((i?"Enabling ":"Disabling ")+"useHTML5Audio via URL parameter");u.setup({useHTML5Audio:i})}if(a.indexOf(r)!==-1){s=a.charAt(a.indexOf(r)+r.length)==="1";o&&console.log((s?"Enabling ":"Disabling ")+"preferFlash via URL parameter");u.setup({preferFlash:s})}})();if(!Bt&&u.hasHTML5){u._wD("SoundManager: No Flash detected"+(u.useHTML5Audio?". Trying HTML5-only mode.":", enabling HTML5."),1);u.setup({useHTML5Audio:!0,preferFlash:!1})}Mt();u.html5.usingFlash=Nt();Tt=u.html5.usingFlash;if(!Bt&&Tt){xt.push(U.needFlash);u.setup({flashLoadTimeout:1})}m.removeEventListener&&m.removeEventListener("DOMContentLoaded",X,!1);z();return!0};Ot=function(){if(m.readyState==="complete"){X();m.detachEvent("onreadystatechange",Ot)}return!0};V=function(){L=!0;_t.remove(e,"load",V)};W=function(){if(Jt){(!u.setupOptions.useHTML5Audio||u.setupOptions.preferFlash)&&xt.push(U.mobileUA);u.setupOptions.useHTML5Audio=!0;u.setupOptions.preferFlash=!1;if(Ut||zt&&!d.match(/android\s2\.3/i)){xt.push(U.globalHTML5);Ut&&(u.ignoreFlash=!0);Pt=!0}}};W();jt();_t.add(e,"focus",R);_t.add(e,"load",F);_t.add(e,"load",V);if(m.addEventListener)m.addEventListener("DOMContentLoaded",X,!1);else if(m.attachEvent)m.attachEvent("onreadystatechange",Ot);else{x("onload",!1);Q({type:"NO_DOM2_EVENTS",fatal:!0})}}var r=null;if(e.SM2_DEFER===undefined||!SM2_DEFER)r=new n;e.SoundManager=n;e.soundManager=r})(window);br_sm2=function(){function e(e){soundManager.setup(o);soundManager.onready(function(){e()})}function t(e){var t=e.sampleTrack?badracket.stringToTime("0:30"):badracket.stringToTime(br_player.state.currSong.duration),n=e.position,r=br_player.state.isSliding;playbarWidth=(n/t*100).toFixed(2)+"%";if(!r&&br_player.state.currSong.sm2_obj===e){br_player.ui.el.progressBar.css("width",playbarWidth);br_player.ui.el.progressTime.text(badracket.msToTime(n))}}function n(e){console.log("on finish ran");e.setPosition(0);br_player.ui.handlers.nextPrev("next");br_mixpanel.track("Song Ended",{songUrl:e.url,duration:badracket.msToTime(e.duration)});mixpanel.people.increment("Songs finished",1)}function r(e,r){console.log("create sound ran");mixpanel.people.increment("Songs started",1);br_mixpanel.track("Song started");return r?soundManager.createSound({id:"brSound"+u++,url:e.songUrl,autoLoad:!0}):soundManager.createSound({id:"brSound"+u++,url:e.songUrl,autoLoad:!0,onplay:function(){br_player.state.isPlaying=!0;$(window).trigger("sm2-play-event")},onresume:function(){br_player.state.isPlaying=!0;$(window).trigger("sm2-play-event")},onpause:function(){br_player.state.isPlaying=!1},onstop:function(){br_player.state.isPlaying=!1},whileplaying:function(){t(this)},onfinish:function(){n(this)}})}function i(){var e=br_player.history.song.lastPlayed();typeof e!="undefined"&&"sm2_obj"in e&&e.sm2_obj.loaded===!1&&e.sm2_obj.unload()}function s(e,t,n){console.log("play-pause ran");i();"sm2_obj"in e||(e.sm2_obj=r(e,n));if(e.isSampleTrack==0&&!$("html").hasClass("fb-logged-in")){br_player.logic.attach30SecondListener(e);e.sm2_obj.sampleTrack=!0}else{e.sm2_obj.sampleTrack=!1;br_player.logic.remove30SecondListener(e)}br_player.ui.render.sampleState(e);t?e.sm2_obj.pause():e.sm2_obj.togglePause()}var o={url:"swf",flashVersion:9,debugMode:!1,flashPollingInterval:125,html5PollingInterval:125,useHighPerformance:!0},u=0;return{setup:e,createSound:r,playPause:s,onFinish:n}}();br_inline_player=function(){function e(e){var n;_.each(t,function(t){t.songUrl===e&&(n=t)});return n}var t=[],n={playClick:function(){console.log("inline-play-click-bound");s.bd.on({click:function(e){r.playClick(e)}},".inline-play-pause")}},r={playClick:function(n){var r=$(n.target).closest(".inline-player"),i=r.data("song-url"),s=e(i),o=r.find(".inline-play-pause");$(window).trigger("vimeo-play-event",i);if(s){s.sm2_obj.togglePause();var u=s.sm2_obj.paused?"m":"n";o.attr("data-icon",u)}else{var a={songUrl:i};t.push(a);br_sm2.playPause(a,!1,!0);o.attr("data-icon","n");$(window).on("sm2-play-event vimeo-play-event",function(e,t){if(t===a.songUrl)return!1;a.sm2_obj.pause();o.attr("data-icon","m")})}}};return{bindUI:n}}();br_inline_player.bindUI.playClick();br_player=function(){var e={isPreviewSong:!1,isSliding:!1,isPlaying:!1,currSong:null,currAlbum:null},t=function(){var t={playerWrapper:$(".audio-player-wrapper"),player:$(".audio-player"),song:$(".audio-player .song"),artist:$(".audio-player .artist"),albumLink:$(".audio-player .view-full-album"),progressBar:$(".audio-player .progress-bar"),progressTime:$(".audio-player .progress-time"),currentTrack:$(".audio-player .current-track"),totalTracks:$(".audio-player .total-tracks"),slider:$(".slider"),playButton:$(".play-pause"),prevButton:$(".previous"),nextButton:$(".next"),ctaWrap:$(".support-band"),ctaButton:$(".support-band-button")},o={play:"m",pause:"n",speaker:"s"},u={init:function(e,n){t.player.addClass("ready");if(e.kind==="show"){t.artist.html(n.artist);var r=date("M j",new Date(e.date.split(" ")[0]));t.albumLink.find(".show").text("Playing "+r+": ").show();t.albumLink.find(".target").text("view show");t.albumLink.find(".track-count").hide();t.ctaWrap.attr("data-toggle","none");t.ctaWrap.attr("href",e.albumUrl);t.ctaButton.text("Get Tickets")}else{n.isSampleTrack!=1&&!$("html").hasClass("fb-logged-in")?t.player.addClass("preview-song"):t.player.removeClass("preview-song");t.albumLink.find(".show").hide();t.artist.html(e.artist);t.albumLink.find(".track-count").show();t.albumLink.find(".target").text("View album");t.ctaWrap.attr("data-toggle","modal");t.ctaWrap.attr("href","#buy-album-form");t.ctaButton.text("Get Album")}t.song.html(n.songTitle);t.progressBar.css("width","0%");t.progressTime.html(n.duration);t.albumLink.attr("href",e.albumUrl);t.currentTrack.html(parseInt(n.trackNumber,10));t.totalTracks.html(e.tracks.length)},playState:function(){var n=e.isPlaying?o.pause:o.play;t.playButton.attr("data-icon",n)},sampleState:function(e){e.isSampleTrack!=1&&!$("html").hasClass("fb-logged-in")?t.player.addClass("preview-song"):t.player.removeClass("preview-song")},updateTime:function(e){t.progressTime.html(e)}},a={playClick:function(){br_player.logic.targetSong(e.currAlbum,e.currSong);u.playState();br_mixpanel.track("Click: Play / Pause")},albumClick:function(e){var t=$(e.target);if(br_state.viewGet()==="album-detail"||t.closest("a").hasClass("link-to-album"))return!1;e.preventDefault();e.stopPropagation();var i=t.closest(".album").attr("data-album-title"),s=r.getAlbumByName(i),o=r.sampleSong(s);n.targetSong(s,o);br_mixpanel.track("Click: Album",{albumTitle:i})},songClick:function(e){var t=$("[data-album-title]").attr("data-album-title"),i=r.getAlbumByName(t),s=parseInt($(e.target).closest(".song").attr("data-track-number"),10)-1,o=i.tracks[s];n.targetSong(i,o);br_mixpanel.track("Click: Song",{songTitle:o.songTitle})},nextPrev:function(e){var t,r;if(e==="next"){t=i.song.next();n.targetSong(t[0],t[1])}else{previousAlbumSong=i.song.previous();n.targetSong(previousAlbumSong[0],previousAlbumSong[1])}br_mixpanel.track("Click: Next / Previous")},buyAlbum:function(e){e.preventDefault();var t=br_player.state.currAlbum,n=t.albumName,r=t.zipFile,i="$"+t.price+".00",s=t.price*100,o=t.artist,u=t.coverUrl;badracket.setupPayForm(u,n,o,i,r);br_mixpanel.track("Click: Buy Album")},buyAlbumHover:function(){function e(){console.log("yep");s.bd.off("hover",".support-band-button")}badracket.loader.require([badracket_theme_path+"/js/prod/payments.min.js"],e())},whileSliding:function(e,n,r){t.progressBar.css("width",n.value+"%")},slideStart:function(){e.isSliding=!0;br_mixpanel.track("Drag: Progress bar")},slideStop:function(t,n){e.isSliding=!1;var r;br_player.state.currSong.isSampleTrack==0&&!$("html").hasClass("fb-logged-in")?r=n.value/100*3e4:r=n.value/100*badracket.stringToTime(e.currSong.duration);e.currSong.sm2_obj.setPosition(r)},rewind:function(){s=br_player.history.song.current();s.sm2_obj&&s.sm2_obj.setPosition(0)}},f={play:function(){s.bd.on({click:function(){a.playClick()}},".play-pause")},next:function(){s.bd.on({click:function(){a.nextPrev("next")}},".audio-player .next")},previous:function(){s.bd.on({click:function(){a.nextPrev("prev")}},".previous")},album:function(){s.bd.on({click:function(e){a.albumClick(e)}},".album")},song:function(){s.bd.on({click:function(e){a.songClick(e)}},".song")},buyAlbum:function(){s.bd.on({click:function(e){a.buyAlbum(e)}},".support-band-button")},buyAlbumHover:function(){s.bd.on({hover:function(e){a.buyAlbumHover(e)}},".support-band-button")},slider:function(){t.slider.slider({step:.01,slide:function(e,t){a.whileSliding(e,t)},start:function(){a.slideStart()},stop:function(e,t){a.slideStop(e,t)}})}};return{el:t,handlers:a,bindui:f,render:u}}(),n=function(){function n(e,t,n){var r=$('.song[data-track-number="'+t.trackNumber+'"]'),i=$('.album[data-album-title="'+e.albumName+'"]'),s=br_state.viewGet();console.log(s);s==="album-detail"||s==="show-detail"?$("[data-album-title]").attr("data-album-title")===e.albumName&&(n==="toggle"?r.toggleClass("song-playing"):r.removeClass("song-playing")):n==="toggle"?i.toggleClass("playing"):i.removeClass("playing")}function r(r,s,o){if(s.songTitle!==e.currSong.songTitle){typeof e.currSong.sm2_obj!="undefined"&&e.currSong.sm2_obj.setPosition(0);t.render.init(r,s);n(e.currAlbum,e.currSong,"clear");e.isPlaying&&e.currSong.sm2_obj.stop();i.update(r,s)}n(r,s,"toggle");br_sm2.playPause(s,o);t.render.playState()}function s(e){var t=e.sm2_obj;t.onPosition(26e3,function(e){u(t)});t.onPosition(3e4,function(){br_sm2.onFinish(e.sm2_obj)})}function o(e){var t=e.sm2_obj;t.clearOnPosition(26e3);t.clearOnPosition(3e4)}function u(e){var t=e.volume;if(t===0){setTimeout(function(){e.setVolume(100)},1e3);return!1}e.setVolume(Math.min(100,t-1));setTimeout(function(){u(e)},40)}return{targetSong:r,attach30SecondListener:s,remove30SecondListener:o}}(),r=function(){function e(e){r=r.concat(e);i=r.length}function t(e){for(var t=i;t--;)if(r[t].albumName===e)return r[t]}function n(e){var t=e.tracks;for(var n=0;n<t.length;n++)if(parseInt(t[n].isSampleTrack,10)==1)return t[n]}var r=[],i;return{getAlbumByName:t,sampleSong:n,set:e,get:function(){return r}}}(),i=function(){function t(e,t){a=r.get().indexOf(e);f=e.tracks.indexOf(t);u.push([a,f]);s(e,t);console.log("updatehistory ran")}function n(){return u}function s(t,n){console.log(e);e.currAlbum=t;e.currSong=n}function o(){return u.length}var u=[],a,f,l=function(){function e(){return r.get()[a]}function t(){return r.get()[a+1]}function n(){return r.get()[a-1]}function i(){var e=br_player.albumData.get();return e[Math.round(Math.random(0,e.length))]}return{current:e,next:t,previous:n,random:i}}(),c=function(){function t(){return r.get()[a].tracks[f]}function n(){c=r.get();h=c.length;p=e.currAlbum.tracks.length;d=i.album.next();v=i.album.previous()}function s(){n();var t=f+1;if(t>=p){if(a>=h-1){var r=c[0],i=r.tracks[0];return[r,i]}var s=d.tracks[0];return[d,s]}nextSong=e.currAlbum.tracks[t];return[e.currAlbum,nextSong]}function o(){n();var t=f-1;if(t<0){if(a<=0){var r=c[h-1],i=r.tracks[r.tracks.length-1];return[r,i]}var s=v.tracks[v.tracks.length-1];return[v,s]}previousSong=e.currAlbum.tracks[t];return[e.currAlbum,previousSong]}function l(){var e=u[u.length-2],t,n;if(typeof e!="undefined"){t=e[0],n=e[1];return r.get()[t].tracks[n]}}var c,h,p,d,v;return{current:t,next:s,previous:o,lastPlayed:l}}();return{get:n,update:t,length:o,album:l,song:c}}();return{state:e,ui:t,logic:n,albumData:r,history:i}}();$.subscribe("/view/change",updateView("/view/change"));init=function(){function e(){typeof soundManager!="undefined"?br_sm2.setup(t):setTimeout(function(){e()},125)}function t(){console.log("Soundmanager ready");i.sm=!0;$(window).on("vimeo-play-event",function(){var e=br_player.state.currAlbum,t=br_player.state.currSong;br_player.logic.targetSong(e,t,!0)});r()}function n(e){console.log("Album data ready");i[e]=!0;r()}function r(){if(!i.sm||!i.album||!i.show)return;console.log("everything is loaded");doMoreStuff()}var i={sm:!1,album:!1,show:!1};return{loadSM:e,dataReady:n,readyState:i,init:init}}();init.loadSM();