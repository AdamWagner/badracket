(function(e,t){"use strict";t.support.touch="ontouchstart"in window||window.DocumentTouch&&e instanceof DocumentTouch;var n=10,r=".__tap-helper",i="tap",s=0,o="clientX clientY screenX screenY pageX pageY".split(" "),u=function(){var e=function(e,t){e!==undefined&&this.init(e,t)},i=e.prototype;i.init=function(e,t){this.$target=e;this.selector=t.selector;this.data=t.data;this.namespace=r+s++;this.startX=0;this.startY=0;this.isTracking=!1;return this.setupHandlers().reset().enable()};i.setupHandlers=function(){this.onDown=t.proxy(this._onDown,this);this.onMove=t.proxy(this._onMove,this);this.onUp=t.proxy(this._onUp,this);this.onCancel=t.proxy(this._onCancel,this);return this};i.enable=function(){this.$target.on("mousedown"+this.namespace,this.selector,this.onDown);return this};i.disable=function(){this.$target.off("mousedown"+this.namespace,this.selector,this.onDown);return this};i.reset=function(){this.startX=0;this.startY=0;this.isTracking=!1;return this};i.destroy=function(){this.onCancel();return this.disable()};i.getCoordinates=function(e){return[e.clientX,e.clientY]};i._onDown=function(e){if(this.isTracking)return;this.isTracking=!0;var t=this.getCoordinates(e);this.startX=t[0];this.startY=t[1];this.$target.on("mousemove"+this.namespace,this.onMove).on("click"+this.namespace,this.selector,this.onUp)};i._onMove=function(e){var t=this.getCoordinates(e);(Math.abs(t[0]-this.startX)>n||Math.abs(t[1]-this.startY)>n)&&this.onCancel()};i._onUp=function(e){if(!e.isTrigger&&!e.originalEvent.triggeredTap){e.originalEvent.triggeredTap=!0;e.type="tap";e.data=this.data;this.$target.trigger(e)}this.onCancel()};i._onCancel=function(e){this.reset();this.$target.off("mousemove"+this.namespace,this.onMove).off("click"+this.namespace,this.selector,this.onUp)};return e}(),a=function(e){var n=function(e,n){var r=0,s=o.length,u=e.originalEvent.changedTouches[0],a=t.Event(i,e);a.type=i;a.data=n;for(;r<s;r++)a[o[r]]=u[o[r]];return a},r=function(e,t){e!==undefined&&this.init(e,t)},s=r.prototype=new e;s.constructor=r;var u=e.prototype;s.init=function(e,t){this.touchStartCount=0;return u.init.call(this,e,t)};s.enable=function(){this.$target.on("touchstart"+this.namespace,this.selector,this.onDown);return this};s.disable=function(){this.$target.off("touchstart"+this.namespace,this.selector,this.onDown);return this};s.reset=function(){this.touchStartCount=0;return u.reset.call(this)};s.getCoordinates=function(e){return[e.originalEvent.touches[0].clientX,e.originalEvent.touches[0].clientY]};s._onDown=function(e){this.touchStartCount=e.originalEvent.touches.length;if(this.isTracking)return;this.isTracking=!0;this.startX=e.originalEvent.touches[0].clientX;this.startY=e.originalEvent.touches[0].clientY;this.$target.on("touchmove"+this.namespace,this.selector,this.onMove).on("touchend"+this.namespace,this.selector,this.onUp).on("touchcancel"+this.namespace,this.selector,this.onCancel)};s._onUp=function(e){if(!this.touchStartCount||e.originalEvent.touches.length>0||this.touchStartCount>1)return;if(!e.originalEvent.triggeredTap){e.originalEvent.triggeredTap=!0;this.$target.trigger(n(e,this.data))}this.onCancel()};s._onCancel=function(e){this.reset();this.$target.off("touchmove"+this.namespace,this.selector,this.onMove).off("touchend"+this.namespace,this.selector,this.onUp).off("touchcancel"+this.namespace,this.selector,this.onCancel)};return r}(u);t.event.special[i]={add:function(e){var n=t.support.touch?a:u;e.tap=new n(t(this),e)},remove:function(e){e.tap&&e.tap.destroy&&e.tap.destroy()}}})(document,jQuery);