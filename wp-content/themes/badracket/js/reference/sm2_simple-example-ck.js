/**
 *
 * SoundManager 2 Demo: Play MP3 links "in-place"
 * ----------------------------------------------
 *
 * http://schillmania.com/projects/soundmanager2/
 *
 * A simple demo making MP3s playable "inline"
 * and easily styled/customizable via CSS.
 *
 * Requires SoundManager 2 Javascript API.
 *
 */function InlinePlayer(){var e=this,t=this,n=soundManager,r=navigator.userAgent.match(/msie/i);this.playableClass="inline-playable";this.excludeClass="inline-exclude";this.links=[];this.sounds=[];this.soundsByURL=[];this.indexByURL=[];this.lastSound=null;this.soundCount=0;this.config={playNext:!1,autoPlay:!1};this.css={sDefault:"sm2_link",sLoading:"sm2_loading",sPlaying:"sm2_playing",sPaused:"sm2_paused"};this.addEventHandler=typeof window.addEventListener!="undefined"?function(e,t,n){return e.addEventListener(t,n,!1)}:function(e,t,n){e.attachEvent("on"+t,n)};this.removeEventHandler=typeof window.removeEventListener!="undefined"?function(e,t,n){return e.removeEventListener(t,n,!1)}:function(e,t,n){return e.detachEvent("on"+t,n)};this.classContains=function(e,t){return typeof e.className!="undefined"?e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)")):!1};this.addClass=function(t,n){if(!t||!n||e.classContains(t,n))return!1;t.className=(t.className?t.className+" ":"")+n};this.removeClass=function(t,n){if(!t||!n||!e.classContains(t,n))return!1;t.className=t.className.replace(new RegExp("( "+n+")|("+n+")","g"),"")};this.getSoundByURL=function(t){return typeof e.soundsByURL[t]!="undefined"?e.soundsByURL[t]:null};this.isChildOfNode=function(e,t){if(!e||!e.parentNode)return!1;t=t.toLowerCase();do e=e.parentNode;while(e&&e.parentNode&&e.nodeName.toLowerCase()!=t);return e.nodeName.toLowerCase()==t?e:null};this.events={play:function(){t.removeClass(this._data.oLink,this._data.className);this._data.className=t.css.sPlaying;t.addClass(this._data.oLink,this._data.className)},stop:function(){t.removeClass(this._data.oLink,this._data.className);this._data.className=""},pause:function(){t.removeClass(this._data.oLink,this._data.className);this._data.className=t.css.sPaused;t.addClass(this._data.oLink,this._data.className)},resume:function(){t.removeClass(this._data.oLink,this._data.className);this._data.className=t.css.sPlaying;t.addClass(this._data.oLink,this._data.className)},finish:function(){t.removeClass(this._data.oLink,this._data.className);this._data.className="";if(t.config.playNext){var e=t.indexByURL[this._data.oLink.href]+1;e<t.links.length&&t.handleClick({target:t.links[e]})}}};this.stopEvent=function(e){typeof e!="undefined"&&typeof e.preventDefault!="undefined"?e.preventDefault():typeof event!="undefined"&&typeof event.returnValue!="undefined"&&(event.returnValue=!1);return!1};this.getTheDamnLink=r?function(e){return e&&e.target?e.target:window.event.srcElement}:function(e){return e.target};this.handleClick=function(t){if(typeof t.button!="undefined"&&t.button>1)return!0;var r=e.getTheDamnLink(t);if(r.nodeName.toLowerCase()!="a"){r=e.isChildOfNode(r,"a");if(!r)return!0}var i=r.getAttribute("href");if(!r.href||!n.canPlayLink(r)&&!e.classContains(r,e.playableClass)||e.classContains(r,e.excludeClass))return!0;var s=r.href,o=e.getSoundByURL(s);if(o)if(o==e.lastSound)o.togglePause();else{n._writeDebug("sound different than last sound: "+e.lastSound.id);e.lastSound&&e.stopSound(e.lastSound);o.togglePause()}else{e.lastSound&&e.stopSound(e.lastSound);o=n.createSound({id:"inlineMP3Sound"+e.soundCount++,url:s,onplay:e.events.play,onstop:e.events.stop,onpause:e.events.pause,onresume:e.events.resume,onfinish:e.events.finish,type:r.type||null});o._data={oLink:r,className:e.css.sPlaying};e.soundsByURL[s]=o;e.sounds.push(o);o.play()}e.lastSound=o;typeof t!="undefined"&&typeof t.preventDefault!="undefined"?t.preventDefault():event.returnValue=!1;return!1};this.stopSound=function(e){soundManager.stop(e.id);soundManager.unload(e.id)};this.init=function(){n._writeDebug("inlinePlayer.init()");var t=document.getElementsByTagName("a"),r=0;for(var i=0,s=t.length;i<s;i++)if((n.canPlayLink(t[i])||e.classContains(t[i],e.playableClass))&&!e.classContains(t[i],e.excludeClass)){e.addClass(t[i],e.css.sDefault);e.links[r]=t[i];e.indexByURL[t[i].href]=r;r++}if(r>0){e.addEventHandler(document,"click",e.handleClick);e.config.autoPlay&&e.handleClick({target:e.links[0],preventDefault:function(){}})}n._writeDebug("inlinePlayer.init(): Found "+r+" relevant items.")};this.init()}var inlinePlayer=null;soundManager.setup({debugMode:!0,preferFlash:!1,useFlashBlock:!0,url:"../../swf/",flashVersion:9});soundManager.onready(function(){inlinePlayer=new InlinePlayer});