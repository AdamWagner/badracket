function event_init(){for(i=0;i<openPlaylist.length;i++){var e=$("song"+i);if(e){e.addEvent("mouseover",function(){e.addClass("hover")});e.addEvent("mouseout",function(){e.removeClass("hover")});e.addEvent("click",function(e){targ=e.target||e.srcElement;targ.id.indexOf("song")!=-1?togglePlayback(targ.id):targ.parentNode.id.indexOf("song")!=-1?togglePlayback(targ.parentNode.id):targ.parentNode.parentNode.id.indexOf("song")!=-1?togglePlayback(targ.parentNode.parentNode.id):targ.parentNode.parentNode.parentNode.id.indexOf("song")!=-1&&togglePlayback(targ.parentNode.parentNode.parentNode.id)})}}}function togglePlayback(e){e=parseInt(e.replace(/song/,""));songClock=$$("#song"+currentTrack+" .clock");songItem=$("song"+currentTrack);if(e==currentTrack&&typeof currentTrack!="undefined")if(playerStatus=="PAUSED"){songClock.removeClass("grey");songClock.addClass("green");playerObj[0].resume()}else{songClock.removeClass("green");songClock.addClass("grey");playerObj[0].pause()}else{cleanTrackDisplay(currentTrack);currentTrack=e;playTrack()}}function playTrack(){playerObj[0]&&playerObj[0].destruct();if(playerObj[1]){tmp=playerObj.shift();setupTrackDisplay(currentTrack);return!0}try{playerObj[0]=soundManager.createSound({id:"playerObj"+currentTrack,url:"songs/"+Base64.decode(openPlaylist[currentTrack]),autoLoad:!0,autoPlay:!0,onload:sm_onload,onplay:sm_onplay,onresume:sm_onresume,onpause:sm_onpause,whileplaying:sm_whileplaying,onfinish:sm_onfinish,volume:80})}catch(e){debug("Cant create sound: "+e.description)}setupTrackDisplay(currentTrack)}function loadNextTrack(){debug("loadNextTrack() called");if(!openPlaylist[currentTrack+1]){debug("This is the last track");return!1}playerObj[1]&&playerObj[1].destruct();try{playerObj[1]=soundManager.createSound({id:"playerObj"+(currentTrack+1),url:"songs/"+Base64.decode(openPlaylist[currentTrack+1]),autoLoad:!0,autoPlay:!1,onload:sm_onload,onplay:sm_onplay,onresume:sm_onresume,onpause:sm_onpause,whileplaying:sm_whileplaying,onfinish:sm_onfinish,volume:0})}catch(e){debug("Cant create sound: "+e.description)}}function beginFadeTransition(){debug("beginFadeTransition() called");playerObj[1].play();fadeOutSound(playerObj[0],-5);fadeInSound(playerObj[1],5)}function fadeInSound(e,t){var n=e.volume;if(n==100)return!1;e.setVolume(Math.min(100,n+t));setTimeout(function(){fadeInSound(e,t)},300)}function fadeOutSound(e,t){var n=e.volume;if(n==0)return!1;e.setVolume(Math.max(0,n+t));setTimeout(function(){fadeOutSound(e,t)},300)}function nextTrack(){if(openPlaylist[currentTrack+1]){cleanTrackDisplay(currentTrack);currentTrack++;playTrack();return!0}return!1}function cleanTrackDisplay(e){if(typeof e=="undefined")return!1;songClock=$$("#song"+e+" .clock");songItem=$("song"+e);songItem.removeClass("hilite");songClock.set("html","")}function setupTrackDisplay(e){songClock=$$("#song"+e+" .clock");songItem=$("song"+e);songClock.removeClass("grey");songClock.addClass("green");songClock.set("html","&mdash;");songItem.addClass("hilite");var t=String($$("#song"+e+" .name").get("html"));t=t.replace("&amp;","&");document.title="► "+t.trim()+" / "+pageTitle}function sm_onload(){currentPlayerObj.readyState==2&&nextTrack()}function sm_onplay(){playerStatus="PLAYING"}function sm_onpause(){playerStatus="PAUSED";document.title=document.title.replace(/\u25BA/,"◼")}function sm_onresume(){playerStatus="PLAYING";document.title=document.title.replace(/\u25FC/,"►")}function sm_onfinish(){nextTrack()}function sm_whileplaying(){if(this.sID!="playerObj"+currentTrack)return!1;player_position=parseInt(this.position/1e3);player_duration=parseInt(this.duration/1e3);if(player_position==currentPos)return!1;var e="",t=player_position%60,n=(player_position-t)/60,r=n?n+":":"",i=n?t<10?"0"+t:t:t;e=r+i;songClock=$$("#song"+currentTrack+" .clock");songClock.set("html",e);currentPos=player_position;debug(player_duration-player_position+"sec remaining");is_fade_enabled()&&player_duration-player_position==10?loadNextTrack():is_fade_enabled()&&player_duration-player_position==5&&beginFadeTransition()}function is_fade_enabled(){return Browser.Platform.ios?!1:!0}var currentTrack,isReady=0,playerStatus="",currentPos,playerObj=Array();typeof soundManager!="undefined"&&soundManager.onready(function(){soundManager.supported()?isReady=1:alert("Unable to load Sound Manager to play audio :(")});window.debug=function(e,t,n,r){try{typeof console!="undefined"&&console.log.apply(console,arguments)}catch(i){typeof console!="undefined"&&console.log(e,t,n,r)}};var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="",n,r,i,s,o,u,a,f=0;e=Base64._utf8_encode(e);while(f<e.length){n=e.charCodeAt(f++);r=e.charCodeAt(f++);i=e.charCodeAt(f++);s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;isNaN(r)?u=a=64:isNaN(i)&&(a=64);t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)}return t},decode:function(e){var t="",n,r,i,s,o,u,a,f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length){s=this._keyStr.indexOf(e.charAt(f++));o=this._keyStr.indexOf(e.charAt(f++));u=this._keyStr.indexOf(e.charAt(f++));a=this._keyStr.indexOf(e.charAt(f++));n=s<<2|o>>4;r=(o&15)<<4|u>>2;i=(u&3)<<6|a;t+=String.fromCharCode(n);u!=64&&(t+=String.fromCharCode(r));a!=64&&(t+=String.fromCharCode(i))}t=Base64._utf8_decode(t);return t},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128)t+=String.fromCharCode(r);else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t},_utf8_decode:function(e){var t="",n=0,r=0,i=0,s=0;while(n<e.length){r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else if(r>191&&r<224){s=e.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|s&63);n+=2}else{s=e.charCodeAt(n+1);c3=e.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(s&63)<<6|c3&63);n+=3}}return t}};