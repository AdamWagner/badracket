badracket.soundmanager={smSetup:function(){badracket.sm=soundManager;badracket.sm.setup({url:"swf",flashVersion:9,debugMode:false,flashPollingInterval:125,html5PollingInterval:125,defaultOptions:{useHighPerformance:true,usePeakData:false,useEQData:false}});
console.log("- - - sm setup ran - - -");badracket.soundmanager.ready();},ready:function(){badracket.sm.onready(function(){console.log("Soundmanager ready");
badracket.soundmanager.init();});},init:function(){badracket.initAudioPlayer();badracket.bindAudioUI();badracket.bindSliderUI(s.playBar);},createSound:function(a){console.log("- - - createSound() ran - - -");
if(a.isSampleTrack==="0"){a.duration="0:30";}return badracket.sm.createSound({id:"brSound"+(badracket.getSm2_objectCount()),url:a.songUrl,debugMode:false,autoLoad:true,onplay:function(){badracket.onPlayResume(this);
},onresume:function(){badracket.onPlayResume(this);},onpause:function(){badracket.onStopPause(this);},onstop:function(){badracket.onStopPause(this);},whileloading:function(){badracket.whileLoading(this);
},whileplaying:function(){badracket.whilePlaying(this);},onfinish:function(){badracket.onFinish(this);},onload:function(){}});}},badracket.initAudioPlayer=function(){var a=badracket.albums,c=a[Math.round(Math.random(0,a.length))],b=badracket.findSampleSong(c);
badracket.updatePlayHistory(c,b);b.sm2_object=badracket.soundmanager.createSound(b);badracket.updateAudioPlayer(c,b);$(".audio-player").addClass("ready");
};badracket.globalPlayState=false;badracket.onPlayResume=function(a){console.log("onPlayResume() ran");badracket.whilePlayingCounter=0;};badracket.onStopPause=function(a){};
badracket.whileLoading=function(c){var a=((c.bytesLoaded/(c.bytesTotal))*100).toFixed(2)+"%";var b=badracket.playHistory.getCurrentSong();if(b.sm2_object===c){$(".loading").css("width",a);
}};badracket.whilePlaying=function(e){badracket.whilePlayingCounter+=1;var d=badracket.playHistory.getCurrentSong(),a=badracket.min_secToMilliseconds(d.duration);
var c=((e.position/(a))*100).toFixed(2)+"%";var b=badracket.sm.sliding;if(b!==true&&badracket.whilePlayingCounter>2&&d.sm2_object===e){$(".controls .position").css("width",c);
$(".sm2_position").text(badracket.msToTime(e.position));}};badracket.onFinish=function(a){console.log("on finish ran");if(a.sID){a.setPosition(0);}else{a.sm2_object.setPosition(0);
}badracket.handleNextClick("next");};badracket.sampleSongTest=function(){var a=badracket.playHistory.getCurrentSong();if(a.isSampleTrack==="0"){return true;
}};badracket.attach30SecondListener=function(b){var a=b.sm2_object;if(b.isSampleTrack==="0"){console.log("30 second listener attached");a.onPosition(28000,function(c){badracket.fadeOutSound(b);
});a.onPosition(30000,function(c){badracket.onFinish(b);});}};badracket.fadeOutSound=function(c){console.log("- - - fadeOutSound ran - - - ");var b=c.sm2_object;
var a=b.volume;if(a===0){setTimeout(function(){b.setVolume(100);},500);return false;}b.setVolume(Math.min(100,a-1));setTimeout(function(){badracket.fadeOutSound(c);
},20);};badracket.msToTime=function(c){var a=c%1000;c=(c-a)/1000;var b=c%60;c=(c-b)/60;var d=c%60;if(b<10){b="0"+b;}return d+":"+b;};badracket.min_secToMilliseconds=function(a){a=a.toString().split(/:/);
return a[0]*60000+a[1]*1000;};badracket.runFuncAllSongs=function(d){for(var c=0;c<badracket.albums.length;c++){var b=badracket.albums[c].tracks;for(var a=0;
a<b.length;a++){d(b[a]);}}};badracket.loadSampleSongs=function(){badracket.runFuncAllSongs(function(a){if(!a.sm2_object&&a.isSampleTrack){a.sm2_object=badracket.soundmanager.createSound(a);
a.sm2_object.load();}});};badracket.loadNextSong=function(b){var a=badracket.playHistory.getNextSong();if(!b.sm2_object&&b.isSampleTrack){a.sm2_object=badracket.soundmanager.createSound(a);
}a.sm2_object.load();};badracket.stopOtherPlayers=function(a){badracket.runFuncAllSongs(function(b){if(b.sm2_object){if(b.sm2_object.sID!==a){b.sm2_object.pause();
}}});};badracket.getSm2_objectCount=function(){var a=0;badracket.runFuncAllSongs(function(b){if(b.sm2_object){a+=1;}});return a;};badracket.getSongByUrl=function(b){var a;
badracket.runFuncAllSongs(function(c){if(c.songUrl===b){a=c;}});return a;};badracket.playHistory={history:[],getCurrentHistory:function(){return this.history[this.history.length-1];
},getCurrentAlbum:function(){var a=this.getCurrentHistory()[0];return badracket.albums[a];},getNextAlbum:function(){var a=this.getCurrentHistory()[0];return badracket.albums[a+1];
},getPreviousAlbum:function(){var a=this.getCurrentHistory()[0];return badracket.albums[a-1];},getCurrentSong:function(){var a=this.getCurrentHistory()[0];
var b=this.getCurrentHistory()[1];return badracket.albums[a].tracks[b];},getNextSong:function(){var a=this.getCurrentHistory()[0];var b=this.getCurrentHistory()[1];
return badracket.albums[a].tracks[b+1];},getPreviousSong:function(){var a=this.getCurrentHistory()[0];var b=this.getCurrentHistory()[1];return badracket.albums[a].tracks[b-1];
},getCurrentAlbumSong:function(){var a=this.getCurrentHistory()[0];var b=this.getCurrentHistory()[1];return[badracket.albums[a],badracket.albums[a].tracks[b]];
}};badracket.updatePlayHistory=function(c,b){var d=badracket.albums.indexOf(c);var a=c.tracks.indexOf(b);badracket.playHistory.history.push([d,a]);};badracket.runFuncAllAlbums=function(b){for(var a=0;
a<badracket.albums.length;a++){b(badracket.albums[a]);}};badracket.getAlbumByName=function(d){var b=badracket.albums,a=b.length;for(var c=a;c--;){if(b[c].albumName===d){return b[c];
}}};badracket.findSampleSong=function(a){var b=a.tracks;for(var c=0;c<b.length;c++){if(parseInt(b[c].isSampleTrack,10)==1){return b[c];}}};badracket.handlePlayClick=function(){console.log(" - - - handle play click ran - - -");
var a=badracket.playHistory.getCurrentAlbumSong();badracket.playPause(a[1]);badracket.updateAudioDOM(a[0],a[1]);};badracket.handleAlbumClick=function(f){console.log("- - - handle album click ran - - -");
f.preventDefault();var b=$("body").attr("data-view");var c=$(f.target).closest(".album").find(".album-title").text();console.log(c);var a=badracket.getAlbumByName(c);
var h=badracket.playHistory.getCurrentAlbum(),d=badracket.playHistory.getCurrentSong();if(a===h){badracket.playPause(d);badracket.updateAudioDOM(h,d);}else{var g=badracket.findSampleSong(a);
if(b!=="album"){badracket.playPause(g);}badracket.updateAudioDOM(a,g);}};badracket.handleSongClick=function(d){var c=$(d.target);var a=c.closest(".song").find(".trackNumber").text();
var b=badracket.playHistory.getCurrentAlbum();var f=b.tracks[parseInt(a,10)-1];badracket.playPause(f);badracket.updateAudioDOM(b,f);};badracket.handleNextClick=function(e){console.log("- - - handle next click ran - - -");
console.log("direction is "+e);var d=badracket.playHistory.getCurrentHistory();var a=badracket.playHistory.getCurrentAlbum();var f;var c=badracket.playHistory.getCurrentSong();
var g=c.sm2_object.sID;badracket.sm.unload(g);console.log(c.songTitle+" unloaded");c.sm2_object.setPosition(0);if(e==="next"){if((d[1]+1)>=a.tracks.length){if(d[0]+1>=badracket.albums.length){a=badracket.albums[0];
f=a.tracks[0];}else{a=badracket.playHistory.getNextAlbum();f=a.tracks[0];}}else{f=badracket.playHistory.getNextSong();}}else{if((d[1]-1)===-1){if(d[0]===0){a=badracket.albums[badracket.albums.length-1];
f=a.tracks[a.tracks.length-1];}else{a=badracket.playHistory.getPreviousAlbum();f=a.tracks[a.tracks.length-1];}}else{f=badracket.playHistory.getPreviousSong();
}}var b=badracket.playHistory.getPreviousSong();console.log(b);if(b){if(b.sm2_object){var g=b.sm2_object.sID;badracket.sm.unload(g);console.log(b.songTitle+" unloaded");
}}if(badracket.globalPlayState===true){badracket.playPause(f);}else{f.sm2_object=badracket.soundmanager.createSound(f);badracket.attach30SecondListener(f);
f.sm2_object.setVolume(100);}badracket.updateAudioDOM(a,f);};badracket.updateAudioDOM=function(a,b){badracket.updatePlayHistory(a,b);badracket.updateGlobalPlayState();
if($("body").attr("data-view")!=="album"){badracket.updateAlbumCover(a);}badracket.updateAudioPlayer(a,b);if($("body").attr("data-view")==="album"){badracket.updateSongRow(b);
}};badracket.playPause=function(a){if(a.sm2_object){badracket.stopOtherPlayers(a.sm2_object.sID);a.sm2_object.togglePause();}else{a.sm2_object=badracket.soundmanager.createSound(a);
badracket.stopOtherPlayers(a.sm2_object.sID);badracket.attach30SecondListener(a);a.sm2_object.togglePause();}};badracket.updateGlobalPlayState=function(){currentSong=badracket.playHistory.getCurrentSong().sm2_object;
if(currentSong){if(currentSong.playState&&!currentSong.paused){badracket.globalPlayState=true;console.log(currentSong.playState);console.log(currentSong.paused);
console.log("sound playing");}else{console.log(currentSong.playState);console.log(currentSong.paused);badracket.globalPlayState=false;console.log("no sound");
}}};badracket.updateAudioPlayer=function(c,a){console.log(" - - - update audio player ran - - -");var i;if(badracket.globalPlayState===true){i="n";}else{i="m";
}var j=badracket.sampleSongTest(a),g;var h;if($("body").attr("data-view")==="album"){h="";}else{h='<span class="target">View album</span>';}if(j){g="preview-song";
}else{g="";}var l;if(a.sm2_object){var e=a.sm2_object.position;var b=badracket.playHistory.getCurrentSong(),f=badracket.min_secToMilliseconds(b.duration);
var k=((sm2_object.position/(f))*100).toFixed(2)+"%";}var d=['<div class="audio-player ready '+g+'" data-songUrl="'+a.songUrl+'">','<div class="player-metadata group">','<div class="audio-player-title">','<a href="" class="audio-title">','<span class="song">'+a.songTitle+"</span> - ",'<span class="artist">'+c.artist+"</span>","</a>","</div>",'<a class="view-full-album dJAX_internal" href="'+c.albumUrl+'">track '+parseInt(a.trackNumber,10)+" of "+c.tracks.length+"</span> "+h+"</a>","</div>",'<div class="controls group">','<span data-icon="h" class="previous"></span>','<span data-icon="'+i+'" class="play-pause"></span>','<span data-icon="l" class="next"></span>','<div class="statusbar">','<div class="loading"></div>','<div class="slider"></div>','<div class="position" style="width:0%"></div>',"</div>",'<div class="timing">','<div id="sm2_timing" class="timing-data">','<span class="preview-song-indicator">preview</span>','<span class="sm2_position">0:00</span>',"</div>","</div>","</div>"].join("");
$(".audio-player-wrapper").html(d);s.Playbar=$(".controls .position");badracket.bindSliderUI(s.Playbar);};badracket.updateAlbumCover=function(a){$(".album").removeClass("playing");
var c=a.cover;var b=$('[data-src="'+c+'"]');if(badracket.globalPlayState===true){b.parent().parent().addClass("playing");}};badracket.updateSongRow=function(c){var a=c.trackNumber;
$(".track-list .song").each(function(){$(this).removeClass("song-playing").find(".trackNumber").html($(this).attr("data-track-number"));});var b=$("[data-track-number="+a+"]");
if(badracket.globalPlayState===true){b.addClass("song-playing");b.find(".trackNumber").html('<span data-icon="s" class="speaker-indicator"></span>');}};
badracket.onPlayheadSlideStop=function(a){};badracket.whileSliding=function(c,e,b){var a=e.value;b.css("width",a+"%");var d=badracket.playHistory.getCurrentSong();
var f=(a/100)*badracket.min_secToMilliseconds(d.duration);$(".sm2_position").text(badracket.msToTime(f));};badracket.slideStop=function(c,e,b){badracket.sm.sliding=false;
var a=e.value;b.css("width",a+"%");var d=badracket.playHistory.getCurrentSong();var f=(a/100)*badracket.min_secToMilliseconds(d.duration);d.sm2_object.setPosition(f);
$(".sm2_position").text(badracket.msToTime(f));};badracket.bindSliderUI=function(a){console.log("- - - Bind slider UI ran - - -");$(".slider").slider({step:0.01,slide:function(b,c){badracket.whileSliding(b,c,a);
},start:function(){badracket.sm.sliding=true;},stop:function(b,c){badracket.slideStop(b,c,a);}});};badracket.bindAudioUI=function(){$(".play-pause").live("tap, click",function(){console.log("play-pause click");
badracket.handlePlayClick();});$(".next").live("tap, click",function(){badracket.handleNextClick("next");});$(".previous").live("tap, click",function(){badracket.handleNextClick("previous");
});$(".album").live("tap, click",function(a){badracket.handleAlbumClick(a);});$(".song").live("tap, click",function(a){badracket.handleSongClick(a);});
};badracket.soundmanager.djaxInit=function(){var a=badracket.playHistory.getCurrentAlbum();var b=badracket.playHistory.getCurrentSong();if(a){badracket.updateAlbumCover(a);
badracket.updateAudioPlayer(a,b);badracket.updateSongRow(b);}};